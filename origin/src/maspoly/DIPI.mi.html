
<html>
<head>
<title>./maspoly/DIPI.mi</title>
<meta name="generator" content="pas2html 0.9.2">
<meta name="date" content="1995-11-05T13:13:35+00:00">
</head>

<body bgcolor="#FFFFFF">
<pre width="80"><font color="#B22222">(* ----------------------------------------------------------------------------
 * $Id: DIPI.mi,v 1.5 1995/11/05 09:17:21 kredel Exp $
 * ----------------------------------------------------------------------------
 * This file is part of MAS.
 * ----------------------------------------------------------------------------
 * Copyright (c) 1989 - 1992 Universitaet Passau
 * ----------------------------------------------------------------------------
 * $Log: DIPI.mi,v $
 * Revision 1.5  1995/11/05 09:17:21  kredel
 * Improved polynomial parsing.
 *
 * Revision 1.4  1993/03/23  12:58:56  kredel
 * Added DIILFRCD
 *
 * Revision 1.3  1992/10/15  16:28:34  kredel
 * Changed rcsid variable
 *
 * Revision 1.2  1992/02/12  17:33:49  pesch
 * Moved CONST definition to the right place
 *
 * Revision 1.1  1992/01/22  15:14:01  kredel
 * Initial revision
 *
 * ----------------------------------------------------------------------------
 *)</font>

IMPLEMENTATION MODULE DIPI;

<font color="#B22222">(* DIP Integral Implementation Module. *)</font>



<font color="#B22222">(* Import lists and declarations. *)</font>

FROM MASELEM IMPORT MASMIN, MASMAX;


FROM MASSTOR IMPORT LIST, SIL, BETA, LENGTH, SRED, SFIRST,
                    FIRST, RED, COMP, INV, ADV, LIST1;


FROM MASERR IMPORT severe, ERROR;


FROM SACLIST IMPORT LIST2, COMP2, ADV2, FIRST2, 
                    LIST3, AWRITE, CLOUT, CINV, RED2, SECOND, EQUAL;


FROM MASBIOS IMPORT CREAD, CREADB, CWRITE, 
                    SOLINE, LETTER, DIGIT, DIBUFF, 
                    MASORD, BKSP, BLINES, SWRITE;


FROM SACD IMPORT DPR, DQR, DRANN;


FROM SACI IMPORT IDPR, IWRITE, IREAD, IRAND, IMAX, IABSF, 
                 IEXP, IDIF, IGCD, ISIGNF, ILCM, 
                 ISUM, INEG, IQ, IQR;


FROM SACRN IMPORT RNDEN, RNNUM, RNSIGN;


FROM SACPOL IMPORT VREAD, VLSRCH;


FROM DIPC IMPORT DIPNBC, DIPADS, DIPMPM, DIPTCS, DIPMPV, 
                    DIPMRD, DIPCMP, DIPDEG, DIPINV, DIPFMO, 
                    DIPADV, DIPADM, DIPLBC, DIPMCP, DIPMAD, 
                    DIPTCF, DIPEVL, DIPNOV,
                    STVL, BACKUB, 
                    EVRASP, EPREAD, EVRAND, EVDFSI, EVDER, 
                    EVSUM, EVSIGN, EVCOMP;

FROM MASI IMPORT IPROD;
 
<strong><font color="#228B22">CONST</font></strong> rcsidi = "$Id: DIPI.mi,v 1.5 1995/11/05 09:17:21 kredel Exp $";
<strong><font color="#228B22">CONST</font></strong> copyrighti = "Copyright (c) 1989 - 1992 Universitaet Passau";



<strong><font color="#4169E1">PROCEDURE DIIFRP</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial from rational polynomial.
A is a distributive rational polynomial, B is the primitive
positive associate integral polynomial of A. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AL1, ALP, AP, B, BL, CL, EL, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0. *)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*lcm of denominators of base coefficients. *)</font> DIPMAD(A,
      AL1,EL,AP); SL:=RNSIGN(AL1); BL:=RNDEN(AL1); 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> DIPMAD(AP, AL1,EL,AP); AL:=RNDEN(AL1); 
            BL:=ILCM(BL,AL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*multiply with lcm and remove denominators. *)</font> 
      <font color="#4169E1">IF</font> SL &lt; 0 <font color="#4169E1">THEN</font> BL:=INEG(BL); <strong><font color="#4169E1">END</font></strong>; 
      B:=BETA; AP:=A; 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> DIPMAD(AP, AL1,EL,AP); FIRST2(AL1, CL,AL); 
            ALP:=IQ(BL,AL); CL:=IPROD(CL,ALP); B:=DIPMCP(EL,CL,B); <strong><font color="#4169E1">END</font></strong>; 
      B:=INV(B); DIIPCP(B, CL,B); 
<font color="#B22222">(*6*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIFRP; 


<strong><font color="#4169E1">PROCEDURE DIILFR</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial list from rational polynomial list.
A is a list of distributive rational polynomial, B is a list of primitive
positive associate integral polynomials of the polynomials of A. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AP, AL, B, BL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*convert polynomials. *)</font> AP:=A; B:=SIL; 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> ADV(AP, AL,AP); BL:=DIIFRP(AL);  
            B:=COMP(BL,B) <strong><font color="#4169E1">END</font></strong>;
      B:=INV(B); 
<font color="#B22222">(*5*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIILFR; 


<strong><font color="#4169E1">PROCEDURE DIILFRCD</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*DIP integral list from DIP rational list using common denominator.
A is a list of distributive rational polynomial, B is a list of 
associate integral polynomials of the polynomials of A. 
All polynomials in B are multiplied by a least common multiple 
of all denominators of all polynomials in A. *)</font>
<strong><font color="#228B22">VAR</font></strong>   AL, AL1, ALP, AP, B, BP, BL, CL, EL, SL, C, CP: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*lcm of denominators of base coefficients of all polynomials. *)</font> 
      C:=A; CP:=C; BL:=1; 
      <font color="#4169E1">WHILE</font> CP &lt;&gt; SIL <font color="#4169E1">DO</font> ADV(CP, AP,CP); 
            <font color="#4169E1">IF</font> AP = 0 <font color="#4169E1">THEN</font> AP:=SIL <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> DIPMAD(AP, AL1,EL,AP); AL:=RNDEN(AL1); 
                  BL:=ILCM(BL,AL); <strong><font color="#4169E1">END</font></strong>; 
            <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*multiply with lcm and remove denominators. *)</font> 
      CP:=C; BP:=SIL; 
      <font color="#4169E1">WHILE</font> CP &lt;&gt; SIL <font color="#4169E1">DO</font> ADV(CP, AP,CP); 
            <font color="#4169E1">IF</font> AP = 0 <font color="#4169E1">THEN</font> AP:=SIL <strong><font color="#4169E1">END</font></strong>; B:=SIL;  
            <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> DIPMAD(AP, AL1,EL,AP); FIRST2(AL1, CL,AL); 
                  ALP:=IQ(BL,AL); CL:=IPROD(CL,ALP); 
                  B:=DIPMCP(EL,CL,B); <strong><font color="#4169E1">END</font></strong>; 
            B:=INV(B); <font color="#4169E1">IF</font> B = SIL <font color="#4169E1">THEN</font> B:=0 <strong><font color="#4169E1">END</font></strong>; 
            BP:=COMP(B,BP); <strong><font color="#4169E1">END</font></strong>; 
      BP:=INV(BP); RETURN(BP); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIILFRCD; 


<strong><font color="#4169E1">PROCEDURE DIILRD</font></strong>(V: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial list read. V is a
variable list. A list of distributive integral polynomials
in r variables, where r=length(V), r ge 0, is read from
the input stream. any blanks preceding A are skipped. *)</font>
<strong><font color="#228B22">VAR</font></strong>  A, AL, C: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*no list. *)</font> A:=BETA; C:=CREADB(); 
      <font color="#4169E1">IF</font> C &lt;&gt; MASORD("(") <font color="#4169E1">THEN</font> ERROR(severe,"DIILRD ( expected."); 
         RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*read polynomials. *)</font> 
      <font color="#4169E1">REPEAT</font> C:=CREADB(); 
             <font color="#4169E1">IF</font> C = MASORD(",") <font color="#4169E1">THEN</font> C:=CREADB(); <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">IF</font> C &lt;&gt; MASORD(")") <font color="#4169E1">THEN</font> BKSP; AL:=DIIPRD(V); A:=COMP(AL,A); 
                <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> C = MASORD(")"); 
      A:=INV(A); 
<font color="#B22222">(*5*)</font> RETURN(A); <strong><font color="#4169E1">END</font></strong> DIILRD; 


<strong><font color="#4169E1">PROCEDURE DIILWR</font></strong>(A,V: LIST); 
<font color="#B22222">(*Distributive integral polynomial list write. V is a
variable list. A list of distributive integral polynomials
in r variables, where r=length(V), r ge 0, is written to
the output stream. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, OS, LS, RS: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*format. *)</font> BLINES(0); OS:=-1; LS:=10; RS:=60; SOLINE(OS,LS,RS);  
<font color="#B22222">(*2*)</font> <font color="#B22222">(*write polynomials. *)</font> AP:=A; 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; SIL <font color="#4169E1">DO</font> ADV(AP, AL,AP); DIIPWR(AL,V); BLINES(0); 
            <strong><font color="#4169E1">END</font></strong>; 
      SOLINE(OS,LS,RS);
<font color="#B22222">(*5*)</font> RETURN; <strong><font color="#4169E1">END</font></strong> DIILWR; 


<strong><font color="#4169E1">PROCEDURE DIIPAB</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial absolute value. A is a
distributive integral polynomial. B is the absolute value of A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  B, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(* b=a*(sign of a). *)</font> SL:=DIIPSG(A); 
      <font color="#4169E1">IF</font> SL &gt;= 0 <font color="#4169E1">THEN</font> B:=A; <font color="#4169E1">ELSE</font> B:=DIIPNG(A); <strong><font color="#4169E1">END</font></strong>; 
      RETURN(B); 
<font color="#B22222">(*4*)</font> <strong><font color="#4169E1">END</font></strong> DIIPAB; 


<strong><font color="#4169E1">PROCEDURE DIIPCP</font></strong>(A: LIST;  <strong><font color="#228B22">VAR</font></strong> CL,AP: LIST); 
<font color="#B22222">(*Distributive integral polynomial content and primitive part.
A is an distributive integral polynomial, c is the integer
content and AP is the positive primitive part of A. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, DL, EL, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> CL:=0; AP:=A; RETURN; <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*obtain gcd.*)</font> DIPMAD(A, DL,EL,AP); SL:=ISIGNF(DL); 
      <font color="#4169E1">IF</font> SL &lt; 0 <font color="#4169E1">THEN</font> DL:=INEG(DL); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">WHILE</font> (AP &lt;&gt; SIL) <font color="#4169E1">AND</font> (DL &lt;&gt; 1) <font color="#4169E1">DO</font> DIPMAD(AP, AL,EL,AP); 
            DL:=IGCD(DL,AL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*divide. *)</font> CL:=DL; AP:=A; 
      <font color="#4169E1">IF</font> DL = 1 <font color="#4169E1">THEN</font>
         <font color="#4169E1">IF</font> SL &lt; 0 <font color="#4169E1">THEN</font> CL:=-DL; AP:=DIIPNG(A); <strong><font color="#4169E1">END</font></strong>; 
         <font color="#4169E1">ELSE</font>
         <font color="#4169E1">IF</font> SL &lt; 0 <font color="#4169E1">THEN</font> CL:=INEG(DL); <strong><font color="#4169E1">END</font></strong>; 
         AP:=DIIPIQ(A,CL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*6*)</font> RETURN; <strong><font color="#4169E1">END</font></strong> DIIPCP; 


<strong><font color="#4169E1">PROCEDURE DIIPDF</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial difference. A and B are
distributive integral polynomials. C=A-B.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, APP, BL, BP, C, CL, CP, CPP, EL, FL, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(* a or b zero.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> C:=DIIPNG(B); RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> B = 0 <font color="#4169E1">THEN</font> C:=A; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*match coefficients.*)</font> AP:=A; BP:=B; CP:=BETA; 
      <font color="#4169E1">REPEAT</font> EL:=DIPEVL(AP); FL:=DIPEVL(BP); SL:=EVCOMP(EL,FL); 
             <font color="#4169E1">IF</font> SL = 1 <font color="#4169E1">THEN</font> DIPMAD(AP, AL,EL,AP); 
                CP:=DIPMCP(EL,AL,CP); <font color="#4169E1">ELSE</font>
                <font color="#4169E1">IF</font> SL = -1 <font color="#4169E1">THEN</font> DIPMAD(BP, BL,FL,BP); CL:=INEG(BL); 
                   CP:=DIPMCP(FL,CL,CP); <font color="#4169E1">ELSE</font> DIPMAD(AP, AL,EL,AP); 
                   DIPMAD(BP, BL,FL,BP); CL:=IDIF(AL,BL); 
                   <font color="#4169E1">IF</font> CL &lt;&gt; 0 <font color="#4169E1">THEN</font> CP:=DIPMCP(EL,CL,CP); <strong><font color="#4169E1">END</font></strong>; 
                   <strong><font color="#4169E1">END</font></strong>; 
                <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> (AP = SIL) <font color="#4169E1">OR</font> (BP = SIL); 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> APP:=AP; 
      <font color="#4169E1">IF</font> AP = SIL <font color="#4169E1">THEN</font>
         <font color="#4169E1">IF</font> BP &lt;&gt; SIL <font color="#4169E1">THEN</font> APP:=DIIPNG(BP); <strong><font color="#4169E1">END</font></strong>; 
         <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> CP = SIL <font color="#4169E1">THEN</font> C:=APP; <font color="#4169E1">ELSE</font> CPP:=CP; C:=INV(CP); 
         SRED(CPP,APP); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = SIL <font color="#4169E1">THEN</font> C:=0; <strong><font color="#4169E1">END</font></strong>; 
      RETURN(C); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPDF; 


<strong><font color="#4169E1">PROCEDURE DIIPDM</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial derivation main variable.
A is a distributive polynomial. B is the derivation of A
with respect to its main variable.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, ALP, AS, B, EL, EL1, EL2, ELS, FL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a eq 0 or integer.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> DIPEVL(A) = SIL <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=A; B:=BETA; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); ADV(EL, EL1,ELS); 
             <font color="#4169E1">IF</font> EL1 &gt; 0 <font color="#4169E1">THEN</font> ALP:=IPROD(AL,EL1); EL2:=EL1-1; 
                FL:=COMP(EL2,ELS); B:=DIPMCP(FL,ALP,B); <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> (AS = SIL) <font color="#4169E1">OR</font> (EL1 = 0); 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> 
      <font color="#4169E1">IF</font> B = SIL <font color="#4169E1">THEN</font> B:=0; <font color="#4169E1">ELSE</font> B:=INV(B); <strong><font color="#4169E1">END</font></strong>; 
      RETURN(B); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPDM; 


<strong><font color="#4169E1">PROCEDURE DIIPDR</font></strong>(A,IL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial derivation. A is a distributive
polynomial. B is the derivation of A with respect to its i-th
variable, 0 le i le DIPNOV(A).*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, ALP, AS, B, EL, ELP, FL, J1Y, JL, KL, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or il=rl.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
      RL:=DIPNOV(A); KL:=1; J1Y:=RL-IL; JL:=J1Y+1; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=A; B:=BETA; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); EVDER(EL,JL,KL, ELP,FL); 
             <font color="#4169E1">IF</font> FL &lt;&gt; 0 <font color="#4169E1">THEN</font> ALP:=IPROD(AL,FL); 
                B:=DIPMCP(ELP,ALP,B); <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> 
      <font color="#4169E1">IF</font> B = SIL <font color="#4169E1">THEN</font> B:=0; <font color="#4169E1">ELSE</font> B:=INV(B); <strong><font color="#4169E1">END</font></strong>; 
      RETURN(B); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPDR; 


<strong><font color="#4169E1">PROCEDURE DIIPEM</font></strong>(A,AL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial evaluation of main variable.
A is a distributive integral polynomial. a is an integer.
B(x1, ...,x(r-1))=A(x1, ...,x(r-1),a). *)</font>
<strong><font color="#228B22">VAR</font></strong>   B, EL1, EL2, C, AP, J1Y, ALP: LIST;
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a eq 0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*apply horner s method.*)</font> DIPADM(A, EL1,EL2,B,AP); 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; 0 <font color="#4169E1">DO</font> J1Y:=EL1-EL2; ALP:=IEXP(AL,J1Y); 
            B:=DIIPIP(B,ALP); DIPADM(AP, EL1,EL2,C,AP); B:=DIIPSM(B,C); 
            <strong><font color="#4169E1">END</font></strong>; 
      ALP:=IEXP(AL,EL1); B:=DIIPIP(B,ALP); RETURN(B); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPEM; 


<strong><font color="#4169E1">PROCEDURE DIIPEV</font></strong>(A,IL,AL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial evaluation of the i-th variable.
A is a distributive integral polynomial, 1 le i le DIPNOV(A),
a is an integer. B(x1, ...,x(i-1),x(i+1), ...,xr)=
A(x1, ...,x(i-1),a,x(i+1), ...,xr). *)</font>
<strong><font color="#228B22">VAR</font></strong>  ALP, AP, B, BS, C, D, EL1, EL2, J1Y, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a eq 0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*apply horner s method.*)</font> B:=LIST1(0); BS:=B; B:=0; AP:=A; 
      <font color="#4169E1">REPEAT</font> DIPADV(AP,IL, EL1,EL2,D,AP); 
             <font color="#4169E1">WHILE</font> (AP &lt;&gt; 0) <font color="#4169E1">AND</font> (EL1 &gt; EL2) <font color="#4169E1">DO</font> J1Y:=EL1-EL2; 
                   ALP:=IEXP(AL,J1Y); D:=DIIPIP(D,ALP); DIPADV(AP,IL,
                   EL1,EL2,C,AP); D:=DIIPSM(D,C); <strong><font color="#4169E1">END</font></strong>; 
             ALP:=IEXP(AL,EL1); D:=DIIPIP(D,ALP); B:=COMP(D,B); 
             <font color="#4169E1">UNTIL</font> AP = 0; 
      ADV(B, D,B); SFIRST(BS,D); SRED(BS,B); B:=DIIPLS(B); 
<font color="#B22222">(*5*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIPEV; 


<strong><font color="#4169E1">PROCEDURE DIIPEX</font></strong>(A,NL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial exponentiation. A is a
distributive integral polynomial, n is a non-negative beta-
integer. B=A**n. 0**0 is by definition a polynomial in
zero variables. *)</font>
<strong><font color="#228B22">VAR</font></strong>  B, BL, I, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*nl=0.*)</font> 
      <font color="#4169E1">IF</font> NL = 0 <font color="#4169E1">THEN</font> RL:=DIPNOV(A); BL:=DIPFMO(1,BETA); 
         B:=DIPINV(BL,0,RL); RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*a eq 0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*general case.*)</font> B:=A; 
      <font color="#4169E1">FOR</font> I:=1 <font color="#4169E1">TO</font> NL-1 <font color="#4169E1">DO</font> B:=DIIPPR(B,A); <strong><font color="#4169E1">END</font></strong>; 
      RETURN(B); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPEX; 


<strong><font color="#4169E1">PROCEDURE DIIPHD</font></strong>(A,IL,NL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial higher derivation. A is a
distributive integral polynomial. B is the n-th derivation
of A with respect to its i-th variable, 0 le i le DIPNOV(A). *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, ALP, AS, B, EL, ELP, FL, J1Y, JL, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a eq 0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
      RL:=DIPNOV(A); J1Y:=RL-IL; JL:=J1Y+1; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=A; B:=BETA; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); EVDER(EL,JL,NL, ELP,FL); 
             <font color="#4169E1">IF</font> FL &lt;&gt; 0 <font color="#4169E1">THEN</font> ALP:=IPROD(AL,FL); 
                B:=DIPMCP(ELP,ALP,B); <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> 
      <font color="#4169E1">IF</font> B = SIL <font color="#4169E1">THEN</font> B:=0; <font color="#4169E1">ELSE</font> B:=INV(B); <strong><font color="#4169E1">END</font></strong>; 
      RETURN(B); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPHD; 


<strong><font color="#4169E1">PROCEDURE DIIPIP</font></strong>(A,BL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial integer product. A is a
distributive integral polynomial, b is an integer. C=A*b.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, C, EL, PL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or bl=0.*)</font> 
      <font color="#4169E1">IF</font> (A = 0) <font color="#4169E1">OR</font> (BL = 0) <font color="#4169E1">THEN</font> C:=0; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*multiply.*)</font> C:=BETA; AP:=A; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AP, AL,EL,AP); PL:=IPROD(AL,BL); C:=DIPMCP(EL,PL,C); 
             <font color="#4169E1">UNTIL</font> AP = SIL; 
      C:=INV(C); RETURN(C); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPIP; 


<strong><font color="#4169E1">PROCEDURE DIIPIQ</font></strong>(A,BL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial integer quotient. A is a
distributive integral polynomial, b is a nonzero integer,
and b divides any coefficient of A. C=A/b.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, C, EL, QL, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> C:=0; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*divide.*)</font> C:=BETA; AP:=A; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AP, AL,EL,AP); IQR(AL,BL, QL,RL); 
             C:=DIPMCP(EL,QL,C); 
             <font color="#4169E1">UNTIL</font> AP = SIL; 
      C:=INV(C); RETURN(C); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPIQ; 


<strong><font color="#4169E1">PROCEDURE DIIPLS</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial list sum. A is a circular
list of distributive integral polynomials. B is the sum of all
polynomials in A. *)</font>
<strong><font color="#228B22">VAR</font></strong>  B, BP, BPP, C, CP, CPP: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*nothing to do. *)</font> 
      <font color="#4169E1">IF</font> A = SIL <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*merge. *)</font> C:=A; ADV(C, B,CP); 
      <font color="#4169E1">WHILE</font> C &lt;&gt; CP <font color="#4169E1">DO</font> ADV(CP, BP,CPP); BPP:=DIIPSM(B,BP); 
            SFIRST(C,BPP); SRED(C,CPP); C:=CPP; ADV(C, B,CP); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*5*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIPLS; 


<strong><font color="#4169E1">PROCEDURE DIIPMN</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial maximum norm. A is a
distributive integral polynomial. b is the maximum norm of A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, BL, CL, EL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> BL:=0; 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> RETURN(BL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*find maximum.*)</font> AS:=A; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); CL:=IABSF(AL); BL:=IMAX(CL,BL); 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
      RETURN(BL); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPMN; 


<strong><font color="#4169E1">PROCEDURE DIIPNG</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial negative. B= -A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, B, BL, EL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> B:=0; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=A; B:=BETA; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); BL:=INEG(AL); B:=DIPMCP(EL,BL,B); 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
      B:=INV(B); RETURN(B); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPNG; 


<strong><font color="#4169E1">PROCEDURE DIIPON</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial one. A is a distributive
integral polynomial. If A=1 then t=1, otherwise t=0.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, EL, FL, TL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a eq 0.*)</font> TL:=0; 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> RETURN(TL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*a=integer.*)</font> DIPMAD(A, AL,EL,AS); 
      <font color="#4169E1">IF</font> (AL &lt;&gt; 1) <font color="#4169E1">OR</font> (AS &lt;&gt; SIL) <font color="#4169E1">THEN</font> RETURN(TL); <strong><font color="#4169E1">END</font></strong>; 
      FL:=EVSIGN(EL); 
      <font color="#4169E1">IF</font> FL = 0 <font color="#4169E1">THEN</font> TL:=1; <strong><font color="#4169E1">END</font></strong>; 
      RETURN(TL); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPON; 


<strong><font color="#4169E1">PROCEDURE DIIPPR</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial product. A and B are
distributive integral polynomials. C=A*B.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, AS, BL, BS, C, C1, CL, CS, EL, FL, GL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a or b zero.*)</font> 
      <font color="#4169E1">IF</font> (A = 0) <font color="#4169E1">OR</font> (B = 0) <font color="#4169E1">THEN</font> C:=0; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=CINV(A); BS:=B; C:=LIST1(0); CS:=C; 
      <font color="#4169E1">REPEAT</font> DIPMAD(BS, BL,FL,BS); AP:=AS; C1:=BETA; 
             <font color="#4169E1">REPEAT</font> DIPMAD(AP, EL,AL,AP); CL:=IPROD(AL,BL); 
                    GL:=EVSUM(EL,FL); C1:=DIPMCP(CL,GL,C1); 
                    <font color="#4169E1">UNTIL</font> AP = SIL; 
             C:=COMP(C1,C); 
             <font color="#4169E1">UNTIL</font> BS = SIL; 
      ADV(C, C1,C); SFIRST(CS,C1); SRED(CS,C); C:=DIIPLS(C); 
<font color="#B22222">(*5*)</font> RETURN(C); <strong><font color="#4169E1">END</font></strong> DIIPPR; 


<strong><font color="#4169E1">PROCEDURE DIIPPS</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial pseudo-remainder. A and B are
distributive integral polynomials, B ne 0. C is the
pseudo-remainder of A and B. *)</font>
<strong><font color="#228B22">VAR</font></strong>  B1, BP, BS, C, C1, CL, FL, IL, J1Y, LL, LLP, ML, NL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*deg(b)=0.*)</font> NL:=DIPDEG(B); 
      <font color="#4169E1">IF</font> NL = 0 <font color="#4169E1">THEN</font> C:=0; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*deg(b) gt 0.*)</font> ML:=DIPDEG(A); C:=A; DIPADM(B, NL,FL,BS,BP); 
      B1:=DIPCMP(0,BS); 
      <font color="#4169E1">FOR</font> IL:=ML <font color="#4169E1">TO</font> NL BY -1 <font color="#4169E1">DO</font>
          <font color="#4169E1">IF</font> C = 0 <font color="#4169E1">THEN</font> RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
          LL:=DIPDEG(C); 
          <font color="#4169E1">IF</font> LL = IL <font color="#4169E1">THEN</font> DIPADM(C, LLP,FL,CL,C); C:=DIIPPR(C,B1); 
             J1Y:=LL-NL; C1:=DIPCMP(J1Y,CL); BS:=DIIPPR(BP,C1); 
             C:=DIIPDF(C,BS); <font color="#4169E1">ELSE</font> C:=DIIPPR(C,B1); <strong><font color="#4169E1">END</font></strong>; 
          <strong><font color="#4169E1">END</font></strong>; 
      RETURN(C); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPPS; 


<strong><font color="#4169E1">PROCEDURE DIIPQ</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial quotient. A and B are
distributive integral polynomials. B is a non zero divisor
of A. C=B/A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  C, R: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*call diipqr.*)</font> DIIPQR(A,B, C,R); RETURN(C); 
<font color="#B22222">(*4*)</font> <strong><font color="#4169E1">END</font></strong> DIIPQ; 


<strong><font color="#4169E1">PROCEDURE DIIPQR</font></strong>(A,B: LIST;  <strong><font color="#228B22">VAR</font></strong> Q,R: LIST); 
<font color="#B22222">(*Distributive integral polynomial quotient and remainder.
A and B are distributive integral polynomials with B ne 0.
Q and R are unique distributive integral polynomials such
that either B divides A, so Q=A/B and R=0  or B does not
divide A, so A=B*Q+R with DEG(R) minimal.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, BL, BP, DL, ML, NL, Q1, QL, QP, RP, SL, TL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*initialise.*)</font> DIPMAD(B, BL,NL,BP); 
      <font color="#4169E1">IF</font> BP = SIL <font color="#4169E1">THEN</font> BP:=0; <strong><font color="#4169E1">END</font></strong>; 
      Q:=BETA; R:=A; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*compute quotient terms.*)</font> 
      LOOP <font color="#4169E1">IF</font> R = 0 <font color="#4169E1">THEN</font> EXIT <strong><font color="#4169E1">END</font></strong>; 
           ML:=DIPEVL(R); EVDFSI(ML,NL, DL,TL); 
           <font color="#4169E1">IF</font> TL &lt; 0 <font color="#4169E1">THEN</font> EXIT <strong><font color="#4169E1">END</font></strong>; 
           AL:=DIPLBC(R); IQR(AL,BL, QL,SL); 
           <font color="#4169E1">IF</font> SL &lt;&gt; 0 <font color="#4169E1">THEN</font> EXIT <strong><font color="#4169E1">END</font></strong>; 
           Q:=DIPMCP(DL,QL,Q); Q1:=DIPFMO(QL,DL); RP:=DIPMRD(R); 
           QP:=DIIPPR(BP,Q1); R:=DIIPDF(RP,QP); 
           <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> 
      <font color="#4169E1">IF</font> Q = SIL <font color="#4169E1">THEN</font> Q:=0; <font color="#4169E1">ELSE</font> Q:=INV(Q); <strong><font color="#4169E1">END</font></strong>; 
      RETURN; 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPQR; 


<strong><font color="#4169E1">PROCEDURE DIIPRA</font></strong>(RL,KL,LL,EL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial random.
k, l and e are positive beta-digits. e is the
maximal permitted exponent of A in any variable. A is a
random distributive integral polynomial in r variables
max norm of a lt 2**k and maximal l base coefficients. *)</font>
<strong><font color="#228B22">VAR</font></strong>  A, AL, AP, FL, IL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*rl=0.*)</font> A:=0; 
      <font color="#4169E1">IF</font> RL = 0 <font color="#4169E1">THEN</font> AL:=IRAND(KL); A:=DIPFMO(AL,BETA); RETURN(A); 
         <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*call evrand.*)</font> 
      <font color="#4169E1">FOR</font> IL:=1 <font color="#4169E1">TO</font> LL <font color="#4169E1">DO</font> AL:=IRAND(KL); 
          <font color="#4169E1">IF</font> AL &lt;&gt; 0 <font color="#4169E1">THEN</font> FL:=EVRAND(RL,EL); AP:=DIPFMO(AL,FL); 
             A:=DIIPSM(A,AP); <strong><font color="#4169E1">END</font></strong>; 
          <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*5*)</font> RETURN(A); <strong><font color="#4169E1">END</font></strong> DIIPRA; 


<strong><font color="#4169E1">PROCEDURE DIIPRD</font></strong>(V: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial read. V is a variable list.
A distributive integral polynomial A in r variables, where
r=length(V), r ge 0, is read from the input stream. Any
blanks preceding A are skipped. Modified version, orginal
version by G. E. Collins. *)</font>
<strong><font color="#228B22">VAR</font></strong>  A, A1, AL, AP, C, EL, ES, FL, IL, JL, RL, VL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*rl=0 or a=0.*)</font> A:=0; C:=CREADB(); 
      <font color="#4169E1">IF</font> C = 0 <font color="#4169E1">THEN</font> RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
      BKSP; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*initialise.*)</font> C:=CREADB(); BKSP; 
      <font color="#4169E1">IF</font> C = MASORD(",") <font color="#4169E1">THEN</font> ERROR(severe,"DIIPRD no , expected.");  
         RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
      FL:=0; 
      <font color="#4169E1">IF</font> C = MASORD("(") <font color="#4169E1">THEN</font> C:=CREADB(); FL:=1; <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = MASORD(")") <font color="#4169E1">THEN</font>
         <font color="#4169E1">IF</font> FL = 1 <font color="#4169E1">THEN</font> RETURN(A); <font color="#4169E1">ELSE</font> ERROR(severe,"DIIPRD no ) expected.");  
            RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
         <strong><font color="#4169E1">END</font></strong>; 
      RL:=LENGTH(V); ES:=BETA; 
      <font color="#4169E1">FOR</font> IL:=1 <font color="#4169E1">TO</font> RL <font color="#4169E1">DO</font> ES:=COMP(0,ES); <strong><font color="#4169E1">END</font></strong>; 
      A1:=DIPFMO(1,ES); AP:=A1; 
LOOP
<font color="#B22222">(*3*)</font> <font color="#B22222">(*next input. determine next action. *)</font> C:=CREADB(); 
      <font color="#4169E1">IF</font> C = MASORD(")") <font color="#4169E1">THEN</font>
         <font color="#4169E1">IF</font> FL = 0 <font color="#4169E1">THEN</font> BKSP; <strong><font color="#4169E1">END</font></strong>; 
         RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = MASORD(",") <font color="#4169E1">THEN</font> BKSP; RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = MASORD("-") <font color="#4169E1">THEN</font> AP:=DIIPNG(AP); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> (C = MASORD("+")) <font color="#4169E1">OR</font> (C = MASORD("-")) <font color="#4169E1">THEN</font> C:=CREADB(); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = MASORD("*") <font color="#4169E1">THEN</font> C:=CREADB(); <strong><font color="#4169E1">END</font></strong>; 
      BKSP; 
<font color="#B22222">(*4*)</font> <font color="#B22222">(*read coefficient.*)</font> 
      <font color="#4169E1">IF</font> DIGIT(C) <font color="#4169E1">THEN</font> AL:=IREAD(); EL:=EPREAD(); 
         AL:=IEXP(AL,EL); AP:=DIIPIP(AP,AL);  
<font color="#B22222">(*5*)</font> <font color="#B22222">(*read polynomial.*)</font> 
   ELSIF C = MASORD("(") <font color="#4169E1">THEN</font> AL:=DIIPRD(V); EL:=EPREAD(); 
         AL:=DIIPEX(AL,EL); AP:=DIIPPR(AP,AL);  
<font color="#B22222">(*6*)</font> <font color="#B22222">(*read monic monomial.*)</font> 
   ELSIF LETTER(C) <font color="#4169E1">THEN</font> VL:=VREAD(); JL:=VLSRCH(VL,V); 
         <font color="#4169E1">IF</font> JL = 0 <font color="#4169E1">THEN</font> BACKUB; A:=DIIPSM(A,AP); RETURN(A); <strong><font color="#4169E1">END</font></strong>; 
         EL:=EPREAD(); AP:=DIPMPV(AP,JL,EL); 
         <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*8*)</font> <font color="#B22222">(*complete polynomial.*)</font> C:=CREADB(); BKSP; 
      <font color="#4169E1">IF</font> (C = MASORD("+")) <font color="#4169E1">OR</font> (C = MASORD("-")) <font color="#4169E1">OR</font> (C = MASORD(")"))
      <font color="#4169E1">OR</font> (C = MASORD(",")) <font color="#4169E1">THEN</font> A:=DIIPSM(A,AP); AP:=A1; <strong><font color="#4169E1">END</font></strong>; 
      <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*9*)</font> <strong><font color="#4169E1">END</font></strong> DIIPRD; 


<strong><font color="#4169E1">PROCEDURE DIIPSG</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial sign. A is a distributive
integral polynomial. s is the sign of the leading base
coefficient of A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  J1Y, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> SL:=0; <font color="#4169E1">ELSE</font> J1Y:=DIPLBC(A); SL:=ISIGNF(J1Y); 
         <strong><font color="#4169E1">END</font></strong>; 
      RETURN(SL); 
<font color="#B22222">(*4*)</font> <strong><font color="#4169E1">END</font></strong> DIIPSG; 


<strong><font color="#4169E1">PROCEDURE DIIPSM</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial sum. A and B are
distributive integral polynomials. C=A+B. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, APP, BL, BP, C, CL, CP, CPP, EL, FL, SL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(* a or b zero.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> C:=B; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> B = 0 <font color="#4169E1">THEN</font> C:=A; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*match coefficients.*)</font> AP:=A; BP:=B; CP:=BETA; 
      <font color="#4169E1">REPEAT</font> EL:=DIPEVL(AP); FL:=DIPEVL(BP); SL:=EVCOMP(EL,FL); 
             <font color="#4169E1">IF</font> SL = 1 <font color="#4169E1">THEN</font> DIPMAD(AP, AL,EL,AP); 
                CP:=DIPMCP(EL,AL,CP); <font color="#4169E1">ELSE</font>
                <font color="#4169E1">IF</font> SL = -1 <font color="#4169E1">THEN</font> DIPMAD(BP, BL,FL,BP); 
                   CP:=DIPMCP(FL,BL,CP); <font color="#4169E1">ELSE</font> DIPMAD(AP, AL,EL,AP); 
                   DIPMAD(BP, BL,FL,BP); CL:=ISUM(AL,BL); 
                   <font color="#4169E1">IF</font> CL &lt;&gt; 0 <font color="#4169E1">THEN</font> CP:=DIPMCP(EL,CL,CP); <strong><font color="#4169E1">END</font></strong>; 
                   <strong><font color="#4169E1">END</font></strong>; 
                <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> (AP = SIL) <font color="#4169E1">OR</font> (BP = SIL); 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> 
      <font color="#4169E1">IF</font> AP = SIL <font color="#4169E1">THEN</font> APP:=BP; <font color="#4169E1">ELSE</font> APP:=AP; <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> CP = SIL <font color="#4169E1">THEN</font> C:=APP; <font color="#4169E1">ELSE</font> CPP:=CP; C:=INV(CP); 
         SRED(CPP,APP); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> C = SIL <font color="#4169E1">THEN</font> C:=0; <strong><font color="#4169E1">END</font></strong>; 
      RETURN(C); 
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIIPSM; 


<strong><font color="#4169E1">PROCEDURE DIIPSN</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial sum norm. A is a distributive
integral polynomial. b is the sum norm of A.*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, BL, CL, EL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0.*)</font> BL:=0; 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> RETURN(BL); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*sum.*)</font> AS:=A; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,EL,AS); CL:=IABSF(AL); BL:=ISUM(CL,BL); 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
      RETURN(BL); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPSN; 


<strong><font color="#4169E1">PROCEDURE DIIPSO</font></strong>(A: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial sort. A is a
list of integer base coefficients and exponent vectors,
A is sorted with respect to the actual term order,
two terms with equal exponent vectors are added. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AP, B, BP, BS, EL, TL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*trivial case.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*construct monomials.*)</font> B:=LIST1(0); BS:=B; AP:=A; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AP, AL,EL,AP); BP:=DIPFMO(AL,EL); B:=COMP(BP,B); 
             <font color="#4169E1">UNTIL</font> AP = SIL; 
<font color="#B22222">(*3*)</font> <font color="#B22222">(*add monomials.*)</font> ADV(B, BP,B); SFIRST(BS,BP); SRED(BS,B); 
      B:=DIIPLS(B); 
<font color="#B22222">(*6*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIPSO; 


<strong><font color="#4169E1">PROCEDURE DIIPSU</font></strong>(A,IL,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial substitution. A and B are
distributive integral polynomials, 1 le i le r=DIPNOV(A).
E(x1, ...,x(i-1),x(i+1), ...,xr)=A(x1, ...,x(i-1),
B(x1, ...,x(i-1),x(i+1), ...,xr),x(i+1), ...,xr). *)</font>
<strong><font color="#228B22">VAR</font></strong>  AP, BP, BS, C, D, E, EL1, EL2, ES, J1Y, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or b=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> E:=0; RETURN(E); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> B = 0 <font color="#4169E1">THEN</font> E:=DIPTCS(A,IL); RETURN(E); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*apply horner s method.*)</font> BS:=B; E:=LIST1(0); ES:=E; AP:=A; 
      <font color="#4169E1">REPEAT</font> DIPADV(AP,IL, EL1,EL2,D,AP); 
             <font color="#4169E1">WHILE</font> (AP &lt;&gt; 0) <font color="#4169E1">AND</font> (EL1 &gt; EL2) <font color="#4169E1">DO</font> J1Y:=EL1-EL2; 
                   BP:=DIIPEX(BS,J1Y); D:=DIIPPR(D,BP); 
                   DIPADV(AP,IL,EL1,EL2,C,AP); D:=DIIPSM(D,C); <strong><font color="#4169E1">END</font></strong>; 
             BP:=DIIPEX(BS,EL1); D:=DIIPPR(D,BP); E:=COMP(D,E); 
             <font color="#4169E1">UNTIL</font> AP = 0; 
      ADV(E, D,E); SFIRST(ES,D); SRED(ES,E); E:=DIIPLS(E); 
<font color="#B22222">(*5*)</font> RETURN(E); <strong><font color="#4169E1">END</font></strong> DIIPSU; 


<strong><font color="#4169E1">PROCEDURE DIIPSV</font></strong>(A,B: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial substitution for main variable.
A and B are distributive integral polynomials. t=DIPNOV(A)-1.
C(x1, ...,xt)=A(x1, ...,xt,B(x1, ...,xt)). *)</font>
<strong><font color="#228B22">VAR</font></strong>  AP, BP, C, D, EL1, EL2, J1Y: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or b=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> C:=0; RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">IF</font> B = 0 <font color="#4169E1">THEN</font> C:=DIPTCF(A); RETURN(C); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*apply horner s method.*)</font> DIPADM(A, EL1,EL2,C,AP); 
      <font color="#4169E1">WHILE</font> AP &lt;&gt; 0 <font color="#4169E1">DO</font> J1Y:=EL1-EL2; BP:=DIIPEX(B,J1Y); 
            C:=DIIPPR(C,BP); DIPADM(AP, EL1,EL2,D,AP); C:=DIIPSM(C,D); 
            <strong><font color="#4169E1">END</font></strong>; 
      BP:=DIIPEX(B,EL1); C:=DIIPPR(C,BP); RETURN(C); 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPSV; 


<strong><font color="#4169E1">PROCEDURE DIIPTM</font></strong>(A,HL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial translation main variable.
A is a distributive integral polynomial, h is an integer.
B(x1, ...xr)=A(x1, ...,x(r-1),xr+h). r=DIPNOV(A). *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, ALQ, AS, B, B1, B2, EL, ELS, IL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or hl=0.*)</font> 
      <font color="#4169E1">IF</font> (A = 0) <font color="#4169E1">OR</font> (HL = 0) <font color="#4169E1">THEN</font> B:=A; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> DIPADM(A, EL,ELS,AL,AS); B:=DIPCMP(0,AL); 
      LOOP <font color="#4169E1">FOR</font> IL:=1 <font color="#4169E1">TO</font> EL-ELS <font color="#4169E1">DO</font> B1:=DIPMPM(B,1); B2:=DIIPIP(B,HL); 
               B:=DIIPSM(B1,B2); <strong><font color="#4169E1">END</font></strong>; 
           <font color="#4169E1">IF</font> AS = 0 <font color="#4169E1">THEN</font> RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
           DIPADM(AS, EL,ELS,AL,AS); ALQ:=DIPCMP(0,AL); 
           B:=DIIPSM(B,ALQ); 
           <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*5*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIPTM; 


<strong><font color="#4169E1">PROCEDURE DIIPTR</font></strong>(A,HL,IL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial translation. A is a
distributive integral polynomial, h is an integer,
the i-th variable is translated. 1 le i le r=DIPNOV(A).
B(x1, ...,xr)=A(x1, ...,xi+h, ...,xr).*)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, B, BS, C, C1, C2, EL1, EL2, KL, RL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or hl=0.*)</font> 
      <font color="#4169E1">IF</font> (A = 0) <font color="#4169E1">OR</font> (HL = 0) <font color="#4169E1">THEN</font> B:=A; RETURN(B); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*apply horner s method.*)</font> AS:=A; B:=LIST1(0); BS:=B; 
      <font color="#4169E1">REPEAT</font> DIPADS(AS,IL,0, EL1,EL2,C,AS); 
             <font color="#4169E1">WHILE</font> (AS &lt;&gt; 0) <font color="#4169E1">AND</font> (EL1 &gt; EL2) <font color="#4169E1">DO</font>
                   <font color="#4169E1">FOR</font> KL:=1 <font color="#4169E1">TO</font> EL1-EL2 <font color="#4169E1">DO</font> C1:=DIPMPV(C,IL,1); 
                       C2:=DIIPIP(C,HL); C:=DIIPSM(C1,C2); <strong><font color="#4169E1">END</font></strong>; 
                   DIPADS(AS,IL,0, EL1,EL2,AL,AS); C:=DIIPSM(C,AL); <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">FOR</font> KL:=1 <font color="#4169E1">TO</font> EL1 <font color="#4169E1">DO</font> C1:=DIPMPV(C,IL,1); C2:=DIIPIP(C,HL); 
                 C:=DIIPSM(C1,C2); <strong><font color="#4169E1">END</font></strong>; 
             B:=COMP(C,B); 
             <font color="#4169E1">UNTIL</font> AS = 0; 
      ADV(B, C,B); SFIRST(BS,C); SRED(BS,B); B:=DIIPLS(B); 
<font color="#B22222">(*5*)</font> RETURN(B); <strong><font color="#4169E1">END</font></strong> DIIPTR; 


<strong><font color="#4169E1">PROCEDURE DIIPWR</font></strong>(A,V: LIST); 
<font color="#B22222">(*Distributive integral polynomial write. A is a distributive
integral poynomial in r variables, r ge 0. V is a variable list
for A. A is written in the output stream. Modified version,
original version by G. E. Collins. *)</font>
<strong><font color="#228B22">VAR</font></strong>  AL, AS, E, EL, ES, FL, LL, RL, SL, VL, VS: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*rl=0 or a=0.*)</font> 
      <font color="#4169E1">IF</font> A = 0 <font color="#4169E1">THEN</font> AWRITE(A); RETURN; <strong><font color="#4169E1">END</font></strong>; 
      RL:=DIPNOV(A); 
      <font color="#4169E1">IF</font> RL = 0 <font color="#4169E1">THEN</font> IWRITE(DIPLBC(A)); RETURN; <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case.*)</font> AS:=A; FL:=0; LL:=DIPNBC(A); 
      <font color="#4169E1">IF</font> LL &gt; 1 <font color="#4169E1">THEN</font> SWRITE("("); <strong><font color="#4169E1">END</font></strong>; 
      <font color="#4169E1">REPEAT</font> DIPMAD(AS, AL,E,AS); SWRITE(" "); SL:=ISIGNF(AL); 
             <font color="#4169E1">IF</font> (SL &gt; 0) <font color="#4169E1">AND</font> (FL &lt;&gt; 0) <font color="#4169E1">THEN</font> SWRITE("+"); <strong><font color="#4169E1">END</font></strong>; 
             FL:=1; SL:=EVSIGN(E); 
             <font color="#4169E1">IF</font> SL = 0 <font color="#4169E1">THEN</font> IWRITE(AL); <font color="#4169E1">ELSE</font>
                <font color="#4169E1">IF</font> AL = -1 <font color="#4169E1">THEN</font> SWRITE("-"); AL:=1; <strong><font color="#4169E1">END</font></strong>; 
                <font color="#4169E1">IF</font> AL &lt;&gt; 1 <font color="#4169E1">THEN</font> IWRITE(AL); <strong><font color="#4169E1">END</font></strong>; 
                ES:=CINV(E); VS:=V; 
                <font color="#4169E1">REPEAT</font> ADV(ES, EL,ES); ADV(VS, VL,VS); 
                       <font color="#4169E1">IF</font> EL &gt; 0 <font color="#4169E1">THEN</font> SWRITE(" "); CLOUT(VL); 
                          <font color="#4169E1">IF</font> EL &gt; 1 <font color="#4169E1">THEN</font> SWRITE("**"); 
                             AWRITE(EL); <strong><font color="#4169E1">END</font></strong>; 
                          <strong><font color="#4169E1">END</font></strong>; 
                       <font color="#4169E1">UNTIL</font> ES = SIL; 
                <strong><font color="#4169E1">END</font></strong>; 
             <font color="#4169E1">UNTIL</font> AS = SIL; 
      SWRITE(" "); 
      <font color="#4169E1">IF</font> LL &gt; 1 <font color="#4169E1">THEN</font> SWRITE(")"); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*5*)</font> RETURN; <strong><font color="#4169E1">END</font></strong> DIIPWR; 


<strong><font color="#4169E1">PROCEDURE DIIPWV</font></strong>(A: LIST); 
<font color="#B22222">(*Distributive integral polynomial write with standard variable list.
A is a distributive integral poynomial. The standard
variable list is used. A is written in the output stream.*)</font>
<strong><font color="#228B22">VAR</font></strong>  RL, VL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*create variable list.*)</font> RL:=DIPNOV(A); VL:=STVL(RL); 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*write polynomial.*)</font> DIIPWR(A,VL); RETURN; 
<font color="#B22222">(*5*)</font> <strong><font color="#4169E1">END</font></strong> DIIPWV; 


<strong><font color="#4169E1">PROCEDURE DIIRAS</font></strong>(RL,KL,LL,EL,QL: LIST): LIST; 
<font color="#B22222">(*Distributive integral polynomial random sparse exponent vector.
k, l and e are positive beta-digits. e is the
maximal permitted exponent of A in any variable. A is a
random distributive integral polynomial in r variables
max norm of a lt 2**k and maximal l base coefficients. *)</font>
<strong><font color="#228B22">VAR</font></strong>  A, AL, AP, FL, IL, QL1, QL2, QLP, TL: LIST; 
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*rl=0.*)</font> A:=0; 
      <font color="#4169E1">IF</font> RL = 0 <font color="#4169E1">THEN</font> AL:=IRAND(KL); A:=DIPFMO(AL,BETA); RETURN(A); 
         <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*2*)</font> <font color="#B22222">(*call evrand.*)</font> FIRST2(QL, QL1,QL2); DQR(QL1,0,QL2, QLP,TL); 
      <font color="#4169E1">FOR</font> IL:=1 <font color="#4169E1">TO</font> LL <font color="#4169E1">DO</font> AL:=IRAND(KL); 
          <font color="#4169E1">IF</font> AL &lt;&gt; 0 <font color="#4169E1">THEN</font> FL:=EVRASP(RL,EL,QLP); AP:=DIPFMO(AL,FL); 
             A:=DIIPSM(A,AP); <strong><font color="#4169E1">END</font></strong>; 
          <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*5*)</font> RETURN(A); <strong><font color="#4169E1">END</font></strong> DIIRAS; 


<strong><font color="#4169E1">END</font></strong> DIPI.


<font color="#B22222">(* -EOF- *)</font>
</pre>
</body>

</html>
