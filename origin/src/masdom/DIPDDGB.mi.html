
<html>
<head>
<title>./masdom/DIPDDGB.mi</title>
<meta name="generator" content="pas2html 0.9.2">
<meta name="date" content="1994-03-11T15:54:04+00:00">
</head>

<body bgcolor="#FFFFFF">
<pre width="80"><font color="#B22222">(* ----------------------------------------------------------------------------
 * $Id: DIPDDGB.mi,v 1.2 1994/03/11 15:54:04 pesch Exp $
 * ----------------------------------------------------------------------------
 * This file is part of MAS.
 * ----------------------------------------------------------------------------
 * Copyright (c) 1989 - 1993 Universitaet Passau
 * ----------------------------------------------------------------------------
 * $Log: DIPDDGB.mi,v $
 * Revision 1.2  1994/03/11  15:54:04  pesch
 * Minor corrections.
 *
 * Revision 1.1  1993/05/11  10:13:43  kredel
 * Initial Revision
 *
 * ----------------------------------------------------------------------------
 *)</font>

IMPLEMENTATION MODULE DIPDDGB;

<font color="#B22222">(* DIP Domain D-Groebner Bases Implementation Module. *)</font>


<font color="#B22222">(* Author: W. Mark, Uni Passau, 1992. *)</font>


FROM MASSTOR IMPORT LIST, SIL, LENGTH, SFIRST, SRED,
                    FIRST, RED, COMP, INV, ADV, LIST1,
                    CELLS, TIME, BETA;
                    <font color="#B22222">(* BETA = NIL im Interpreter = SIL bei MODULA2 *)</font>

FROM MASERR IMPORT  severe, fatal, ERROR;
        
FROM SACLIST IMPORT FIRST3, LIST3, LIST2, CCONC, CONC, LAST, CINV,
                    SECOND, FIRST2,
                    OWRITE,THIRD,FIRST4, LIST4, EQUAL, RED2, AWRITE, 
                    COMP2, ADV2;

FROM MASBIOS IMPORT BLINES, SWRITE, LISTS;

FROM SACI IMPORT    IPROD, ISUM, IABSF, INEG, ILCM, IQ, IQR, IEGCD,
                    IWRITE, ICOMP, IREM, ISIGNF, IDIF, IGCDCF;

FROM DIPC IMPORT    DIPFMO, DIPMAD, DIPEVL, DIPLBC,
                    VALIS, EVCOMP, EVDIF, EVLCM, EVMT, EVSUM,
                    EVSIGN, DIPLPM,DIPNOV,DIPMCP;

FROM DIPI IMPORT    DIIPDF, DIIPWR, DIIPPR, DIIPSM,
                    DIILWR, DIILRD, DIIPCP, DIIPON, DIIPIP;

FROM MASADOM IMPORT ADPROD, ADSUM, ADNEG, ADLCM, ADQUOT, ADGCDE, 
                    ADSIGN, ADDIF, ADFI, 
                    ADABSF, ADQR, ADCOMP, ADREM;

FROM DIPADOM IMPORT DIPDIF, DIPROD, DIPSUM;


<strong><font color="#228B22">CONST</font></strong> rcsidi = "$Id: DIPDDGB.mi,v 1.2 1994/03/11 15:54:04 pesch Exp $";
<strong><font color="#228B22">CONST</font></strong> copyrighti = "Copyright (c) 1989 - 1993 Universitaet Passau";



<strong><font color="#4169E1">PROCEDURE DIDPELIMDGB</font></strong>(P : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial eliminate D-groebner base.
P is a list of non zero polynomials in distributive
integral representation in r variables.
ELIMDGB eliminates the polynominials with respect
to the divisibility of the highest monominials. *)</font>

<strong><font color="#228B22">VAR</font></strong> Pr, Pf, Qr, Qf, Q, Qv, Qd, HTPf, HTQf, HKPf, HKQf : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> Q:=SIL;
      <font color="#4169E1">IF</font> P = SIL <font color="#4169E1">THEN</font> RETURN(Q); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> (RED(P) = SIL) <font color="#4169E1">THEN</font> RETURN(P); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> Pr:=P;
    LOOP
        ADV(Pr,Pf,Pr);
        <font color="#4169E1">IF</font> Q = SIL
        <font color="#4169E1">THEN</font>
            Q:=LIST1(Pf);
            <font color="#4169E1">IF</font> Pr = SIL
            <font color="#4169E1">THEN</font> RETURN(Q);
            <strong><font color="#4169E1">END</font></strong>;
            ADV(Pr,Pf,Pr);
        <strong><font color="#4169E1">END</font></strong>;
        HTPf:=DIPEVL(Pf);
        HKPf:=DIPLBC(Pf);
        Qr:=Q;
        LOOP
            Qv:=Qr;
            ADV(Qr,Qf,Qr);
            HTQf:=DIPEVL(Qf);
            HKQf:=DIPLBC(Qf);
            <font color="#4169E1">IF</font> EVMT(HTPf,HTQf) = 1
            <font color="#4169E1">THEN</font>
                <font color="#4169E1">IF</font> ADSIGN(ADREM(HKPf,HKQf)) = 0 <font color="#4169E1">THEN</font> EXIT; <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
                <font color="#4169E1">IF</font> EVMT(HTQf,HTPf) = 1
            <font color="#4169E1">THEN</font>
                <font color="#4169E1">IF</font> ADSIGN(ADREM(HKQf,HKPf)) = 0
                    <font color="#4169E1">THEN</font>
                    <font color="#4169E1">IF</font> Q = Qv
                    <font color="#4169E1">THEN</font> Q:=Qr;
                    <font color="#4169E1">ELSE</font>
                        Qd:=Q;
                        <font color="#4169E1">WHILE</font> RED(Qd) &lt;&gt; Qv <font color="#4169E1">DO</font>
                            Qd:=RED(Qd);
                        <strong><font color="#4169E1">END</font></strong>;
                        SRED(Qd,Qr);
                        Qv:=Qd;
                    <strong><font color="#4169E1">END</font></strong>;
                <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> Qr = SIL
            <font color="#4169E1">THEN</font>
                Q:=COMP(Pf,Q);
                EXIT;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> Pr = SIL
        <font color="#4169E1">THEN</font> EXIT;
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*9*)</font> RETURN(Q); <strong><font color="#4169E1">END</font></strong> DIDPELIMDGB;



<strong><font color="#4169E1">PROCEDURE DIDPTDR</font></strong>(P, lcmHT, pair : LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial top-D-reduzibel. P is a list
of non zero polynomials in distributive integral
representation in r variables.
pair is a pair two integral polynomials in
distributive representation.
lcmHT is the lcm of the highest terms of the two
polynomials.
TDR is a boolean value which equals 1, if g is top-D-
reduzibel modulo P and 0 if not. *)</font>

<strong><font color="#228B22">VAR</font></strong>  HKg1, HKg2, HKg, HTg, PP, g : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*s=0. *)</font>
      <font color="#4169E1">IF</font> P = SIL <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(*reduction step.*)</font>
      HKg1:=DIPLBC(FIRST(pair));
      HKg2:=DIPLBC(SECOND(pair));
      PP:=P;
    <font color="#4169E1">REPEAT</font>
        ADV(PP, g, PP);
        HTg:=DIPEVL(g);
        HKg:=DIPLBC(g);
        <font color="#4169E1">IF</font> EVMT(lcmHT,HTg) = 1
        <font color="#4169E1">THEN</font>
        <font color="#4169E1">IF</font> (ADSIGN(ADREM(HKg1,HKg)) = 0) <font color="#4169E1">AND</font> (ADSIGN(ADREM(HKg2,HKg)) = 0)
           <font color="#4169E1">THEN</font> RETURN(1);
           <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">UNTIL</font> PP = SIL;
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> RETURN(0);
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIDPTDR;



<strong><font color="#4169E1">PROCEDURE DIDPCPLMS1</font></strong>(P : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial list construct pairs list merge sort.
P is a list of non zero polynomials in distributive
integral representation in r variables.
CPLMS1 sorts a constructed pairs list in the
following ascending order:
1. lcm of the highest terms
2. lcm of the highest coefficients
P will be changed. *)</font>

<strong><font color="#228B22">VAR</font></strong> onestep, twostep, ret, <strong><font color="#4169E1">end</font></strong>, icomp, evcomp : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(* Wenn P leer sein sollte, dann fertig *)</font>
      <font color="#4169E1">IF</font> P = SIL <font color="#4169E1">THEN</font> RETURN (P); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(* Zuerst wird die Liste geteilt *)</font>
      twostep:=RED(P);
      onestep:=P;
    LOOP
        <font color="#4169E1">IF</font> twostep = SIL
        <font color="#4169E1">THEN</font> EXIT;
        <strong><font color="#4169E1">END</font></strong>;
        twostep:=RED(twostep);
        <font color="#4169E1">IF</font> twostep = SIL
        <font color="#4169E1">THEN</font> EXIT;
        <strong><font color="#4169E1">END</font></strong>;
        twostep:=RED(twostep);
        onestep:=RED(onestep);
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> RED(onestep) = SIL
    <font color="#4169E1">THEN</font> RETURN (onestep);
    <strong><font color="#4169E1">END</font></strong>;
    twostep:=RED(onestep);
        SRED(onestep,SIL);
        onestep:=DIDPCPLMS1(P);
        twostep:=DIDPCPLMS1(twostep);
    <font color="#4169E1">IF</font> onestep = SIL
    <font color="#4169E1">THEN</font> RETURN (twostep);
    ELSIF twostep = SIL
    <font color="#4169E1">THEN</font> RETURN (onestep);
    <strong><font color="#4169E1">END</font></strong>;
        evcomp:=EVCOMP(FIRST(FIRST(onestep)),FIRST(FIRST(twostep)));
    <font color="#4169E1">IF</font> evcomp = -1
    <font color="#4169E1">THEN</font>
        ret:=onestep;
        onestep:=RED(onestep);
    ELSIF evcomp = 1
    <font color="#4169E1">THEN</font>
        ret:=twostep;
        twostep:=RED(twostep);
    <font color="#4169E1">ELSE</font>
        icomp:=ADCOMP(SECOND(FIRST(onestep)),SECOND(FIRST(twostep)));
        <font color="#4169E1">IF</font> icomp = -1
        <font color="#4169E1">THEN</font>
            ret:=onestep;
            onestep:=RED(onestep);
        ELSIF icomp = 1
        <font color="#4169E1">THEN</font>
            ret:=twostep;
            twostep:=RED(twostep);
        <font color="#4169E1">ELSE</font>
            ret:=onestep;
            onestep:=RED(onestep);
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">end</font></strong>:=ret;
    <font color="#4169E1">WHILE</font> (onestep &lt;&gt; SIL) <font color="#4169E1">AND</font> (twostep &lt;&gt; SIL) <font color="#4169E1">DO</font>
        evcomp:=EVCOMP(FIRST(FIRST(onestep)),FIRST(FIRST(twostep)));
        <font color="#4169E1">IF</font> evcomp = -1
        <font color="#4169E1">THEN</font>
            SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
            onestep:=RED(onestep);
        ELSIF evcomp = 1
        <font color="#4169E1">THEN</font>
            SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
            twostep:=RED(twostep);
        <font color="#4169E1">ELSE</font>
            icomp:=ADCOMP(SECOND(FIRST(onestep)),SECOND(FIRST(twostep)));
            <font color="#4169E1">IF</font> icomp = -1
            <font color="#4169E1">THEN</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
                onestep:=RED(onestep);
            ELSIF icomp = 1
            <font color="#4169E1">THEN</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
                twostep:=RED(twostep);
            <font color="#4169E1">ELSE</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
                onestep:=RED(onestep);
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">end</font></strong>:=RED(<strong><font color="#4169E1">end</font></strong>);
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> onestep = SIL
    <font color="#4169E1">THEN</font> SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
    <font color="#4169E1">ELSE</font> SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
    <strong><font color="#4169E1">END</font></strong>;
    RETURN (ret);
<strong><font color="#4169E1">END</font></strong> DIDPCPLMS1;



<strong><font color="#4169E1">PROCEDURE DIDPLM1</font></strong>(onestep, twostep : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial list merge sort.
P is a list of non zero polynomials in distributive
integral representation in r variables.
LM1 merges two (onestep, twostep) constructed
pairs lists in the same manner as DIDPLCPLMS1.
The lists onestep and twostep will be changed. *)</font>

<strong><font color="#228B22">VAR</font></strong> ret, <strong><font color="#4169E1">end</font></strong>, icomp, evcomp : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
    <font color="#4169E1">IF</font> onestep = SIL
    <font color="#4169E1">THEN</font> RETURN(twostep)
    ELSIF twostep = SIL
    <font color="#4169E1">THEN</font> RETURN(onestep)
    <strong><font color="#4169E1">END</font></strong>;
    evcomp:=EVCOMP(FIRST(FIRST(onestep)),FIRST(FIRST(twostep)));
    <font color="#4169E1">IF</font> evcomp = -1
    <font color="#4169E1">THEN</font>
        ret:=onestep;
        onestep:=RED(onestep);
    ELSIF evcomp = 1
    <font color="#4169E1">THEN</font>
        ret:=twostep;
        twostep:=RED(twostep);
    <font color="#4169E1">ELSE</font>
        icomp:=ADCOMP(SECOND(FIRST(onestep)),SECOND(FIRST(twostep)));
        <font color="#4169E1">IF</font> icomp = -1
        <font color="#4169E1">THEN</font>
            ret:=onestep;
            onestep:=RED(onestep);
        ELSIF icomp = 1
        <font color="#4169E1">THEN</font>
            ret:=twostep;
            twostep:=RED(twostep);
        <font color="#4169E1">ELSE</font>
            ret:=onestep;
            onestep:=RED(onestep);
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">end</font></strong>:=ret;
    <font color="#4169E1">WHILE</font> (onestep &lt;&gt; SIL) <font color="#4169E1">AND</font> (twostep &lt;&gt; SIL) <font color="#4169E1">DO</font>
        evcomp:=EVCOMP(FIRST(FIRST(onestep)),FIRST(FIRST(twostep)));
        <font color="#4169E1">IF</font> evcomp = -1
        <font color="#4169E1">THEN</font>
            SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
            onestep:=RED(onestep);
        ELSIF evcomp = 1
        <font color="#4169E1">THEN</font>
            SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
            twostep:=RED(twostep);
        <font color="#4169E1">ELSE</font>
            icomp:=ADCOMP(SECOND(FIRST(onestep)),SECOND(FIRST(twostep)));
            <font color="#4169E1">IF</font> icomp = -1
            <font color="#4169E1">THEN</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
                onestep:=RED(onestep);
            ELSIF icomp = 1
            <font color="#4169E1">THEN</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
                twostep:=RED(twostep);
            <font color="#4169E1">ELSE</font>
                SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
                onestep:=RED(onestep);
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">end</font></strong>:=RED(<strong><font color="#4169E1">end</font></strong>);
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> onestep = SIL
    <font color="#4169E1">THEN</font> SRED(<strong><font color="#4169E1">end</font></strong>,twostep);
    <font color="#4169E1">ELSE</font> SRED(<strong><font color="#4169E1">end</font></strong>,onestep);
    <strong><font color="#4169E1">END</font></strong>;
    RETURN (ret);
<strong><font color="#4169E1">END</font></strong> DIDPLM1;



<strong><font color="#4169E1">PROCEDURE DIDPUCPL1</font></strong>(P, g, Old : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial update constructed pairs list.
P is a list of integral polynomials in distributive
representation. g ist a polynomial in distributive
representation. Both are polynomials in r variables.
Old is the constructed and sorted pairs
list to be updated. *)</font>

<strong><font color="#228B22">VAR</font></strong> Update, Up, Upel, Pr, Pf, pair, a1, a2, t1, t2, lcmHT, lcmHK : LIST;


<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> P = SIL <font color="#4169E1">THEN</font> RETURN(Old); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> g = 0 <font color="#4169E1">THEN</font> RETURN(Old); <strong><font color="#4169E1">END</font></strong>;
      Up:=SIL;
      t1:=DIPEVL(g);
      a1:=DIPLBC(g);
<font color="#B22222">(*2*)</font> Pr:=P;
    <font color="#4169E1">REPEAT</font>
        ADV(Pr,Pf,Pr);
        t2:=DIPEVL(Pf);
        a2:=DIPLBC(Pf);
        lcmHT:=EVLCM(t1,t2);
        lcmHK:=ADLCM(a1,a2);
        pair:=LIST2(g,Pf);
        Upel:=LIST3(lcmHT,lcmHK,pair);
        Up:=COMP(Upel,Up);
    <font color="#4169E1">UNTIL</font> (Pr = SIL);
        Up:=DIDPCPLMS1(Up);
    <font color="#4169E1">IF</font> Old = SIL
    <font color="#4169E1">THEN</font> RETURN(Up);
    <strong><font color="#4169E1">END</font></strong>;
        Update:=DIDPLM1(Up,Old);
<font color="#B22222">(*9*)</font> RETURN(Update); <strong><font color="#4169E1">END</font></strong> DIDPUCPL1;



<strong><font color="#4169E1">PROCEDURE DIDPGPOL</font></strong>(g1,g2: LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial g polynomial. g1 and g2 are
integral polynomials in distributive representation. GPOL is
the G-polynomial of g1 and g2. *)</font>

<strong><font color="#228B22">VAR</font></strong>   a1, g1r, g1rp, a2, g2r, g2rp, GPol,
          gcdHK, t1, s1, t2, s2, c1, c2, lcmHT: LIST;
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or b=0. *)</font> GPol:=0;
    <font color="#4169E1">IF</font> (g1 = 0) <font color="#4169E1">OR</font> (g2 = 0) <font color="#B22222">(* gcd(0,a) = a, lcm(0,a) = 0, *)</font>
       <font color="#4169E1">THEN</font> RETURN(GPol); <strong><font color="#4169E1">END</font></strong>;
    DIPMAD(g1, a1,t1,g1r);  <font color="#B22222">(* a1 = HK(g1), t1 = HT(g2) *)</font>
    DIPMAD(g2, a2,t2,g2r);  <font color="#B22222">(* a2 = HK(g2), t2 = HT(g2) *)</font>
                            <font color="#B22222">(* g1r = g1 - HM(g1) *)</font>
                            <font color="#B22222">(* g2r = g2 - HM(g2) *)</font>
    ADGCDE(a1,a2,gcdHK,c1,c2);
    <font color="#4169E1">IF</font> ADSIGN(c1) = 0       <font color="#B22222">(* GPol = c2*s2*g2 *)</font>
    <font color="#4169E1">THEN</font>
        lcmHT:=EVLCM(t1,t2);
        s2:=EVDIF(lcmHT,t2);
        g2rp:=DIPFMO(c2,s2);
        GPol:=DIPROD(g2,g2rp);
        RETURN(GPol);
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> ADSIGN(c2) = 0       <font color="#B22222">(* GPol = c1*s1*g1 *)</font>
    <font color="#4169E1">THEN</font>
        lcmHT:=EVLCM(t1,t2);
        s1:=EVDIF(lcmHT,t1);
        g1rp:=DIPFMO(c1,s1);
        GPol:=DIPROD(g1,g1rp);
        RETURN(GPol);
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(*general case. *)</font>
      lcmHT:=EVLCM(t1,t2);
      s1:=EVDIF(lcmHT,t1);
      s2:=EVDIF(lcmHT,t2);
      g1rp:=DIPFMO(c1,s1);
      g2rp:=DIPFMO(c2,s2);
      g1rp:=DIPROD(g1,g1rp);
      g2rp:=DIPROD(g2,g2rp);
      GPol:=DIPSUM(g1rp,g2rp); <font color="#B22222">(* GPol = c1*s1*g1 + c2*s2*g2 *)</font>
<font color="#B22222">(*6*)</font> RETURN(GPol);
<strong><font color="#4169E1">END</font></strong> DIDPGPOL;



<strong><font color="#4169E1">PROCEDURE DIDPSPOL2</font></strong>(g1, g2, lcmHT, lcmHK: LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial s polynomial. g1 and g2 are
integral polynomials in distributive representation.
lcmHT is the lcm of the highest terms of g1 and g2.
lcmHK is the lcm of the highest coefficients of g1 and g2.
polynomials in pair.
SPol is the S-polynomial of g1 and g2. *)</font>

<strong><font color="#228B22">VAR</font></strong>   a1, b1, g1r, g1rp, a2, b2, g2r, g2rp, SPol,
      t1, s1, t2, s2 : LIST;
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or b=0. *)</font> SPol:=0;
    <font color="#4169E1">IF</font> (g1 = 0) <font color="#4169E1">OR</font> (g2 = 0)
       <font color="#4169E1">THEN</font> RETURN(SPol);     <font color="#B22222">(* SPol = 0 *)</font>
    <strong><font color="#4169E1">END</font></strong>;
    DIPMAD(g1, a1,t1,g1r);  <font color="#B22222">(* a1 = HK(g1), t1 = HT(g2), a2 = HK(g2) *)</font>
    DIPMAD(g2, a2,t2,g2r);  <font color="#B22222">(* t2 = HT(g2) g1r = g1 - HM(g1) *)</font>
                            <font color="#B22222">(* g2r = g2 - HM(g2) *)</font>
    <font color="#4169E1">IF</font> (g1r = SIL) <font color="#4169E1">AND</font> (g2r = SIL)
    <font color="#4169E1">THEN</font> RETURN(SPol);      <font color="#B22222">(* SPol = 0 *)</font>
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(* reduction. *)</font>
    <font color="#4169E1">IF</font> g1r = SIL
    <font color="#4169E1">THEN</font>
        s2:=EVDIF(lcmHT,t2);    <font color="#B22222">(* s2 = lcmHT/t2 *)</font>
        b2:=ADQUOT(lcmHK,a2);           <font color="#B22222">(* b2 = lcmHK/a2 *)</font>
        b2:=ADNEG(b2);                   <font color="#B22222">(* b2 = -b2 *)</font>
        g2rp:=DIPFMO(b2,s2);    <font color="#B22222">(* g2rp = -b2*s2 *)</font>
        SPol:=DIPROD(g2r,g2rp); <font color="#B22222">(* SPol = -b2*s2*g2 *)</font>
        RETURN(SPol);
    <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> g2r = SIL
    <font color="#4169E1">THEN</font>
        s1:=EVDIF(lcmHT,t1);
        b1:=ADQUOT(lcmHK,a1);
        g1rp:=DIPFMO(b1,s1);
        SPol:=DIPROD(g1r,g1rp);
        RETURN(SPol);
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*3*)</font> <font color="#B22222">(* general case. *)</font>
      s1:=EVDIF(lcmHT,t1);
      b1:=ADQUOT(lcmHK,a1);
      s2:=EVDIF(lcmHT,t2);
      b2:=ADQUOT(lcmHK,a2);
      g1rp:=DIPFMO(b1,s1);
      g2rp:=DIPFMO(b2,s2);
      g1rp:=DIPROD(g1r,g1rp);
      g2rp:=DIPROD(g2r,g2rp);
      SPol:=DIPDIF(g1rp,g2rp);  <font color="#B22222">(* SPol = b1*s1*g1 - b2*s2*g2 *)</font>
<font color="#B22222">(*6*)</font> RETURN(SPol);
<strong><font color="#4169E1">END</font></strong> DIDPSPOL2;



<strong><font color="#4169E1">PROCEDURE DIDPLEXTAL</font></strong>(AL, g : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial list extend array list.
AL is an array list.
g is a polynomial in distributive representation
in r variables.
Ag is the extended array list of AL.
The list AL is modified. *)</font>

<strong><font color="#228B22">VAR</font></strong> i, j, nulll, gp, Ag : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> g = 0 <font color="#4169E1">THEN</font> RETURN(AL); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> AL = SIL <font color="#4169E1">THEN</font>
        Ag:=LIST1(LIST2(g,LIST1(1)));
        RETURN(Ag); <font color="#B22222">(* length of the polynomial *)</font>
        <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> i:=FIRST(SECOND(FIRST(AL)));
      j:=0;
      nulll:=SIL;
      <font color="#4169E1">WHILE</font> j &lt; i <font color="#4169E1">DO</font> nulll:=COMP(0,nulll); j:=j+1; <strong><font color="#4169E1">END</font></strong>;
      gp:=LIST2(g,nulll);
      Ag:=AL;
      SRED(LAST(Ag),LIST1(gp));
      SFIRST(SECOND(FIRST(Ag)),i+1);
<font color="#B22222">(*9*)</font> RETURN(Ag); <strong><font color="#4169E1">END</font></strong> DIDPLEXTAL;



<strong><font color="#4169E1">PROCEDURE DIDPLCPL4</font></strong>(P : LIST; <strong><font color="#228B22">VAR</font></strong> CPL, AL : LIST);
<font color="#B22222">(*Distributive domain polynomial list construct pair list.
P is a list of polynomials in distributive
representation in r variables.
CPL is the constructed pairs list, AL is the
Array list. *)</font>

<strong><font color="#228B22">VAR</font></strong> CPLel, Pf, Pr , Pfp, Prp, t1, t2, lcmHT, a1, a2, lcmHK : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> P = SIL <font color="#4169E1">THEN</font> RETURN; <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> RED(P) = SIL <font color="#4169E1">THEN</font> RETURN; <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> Pr:=P;
    <font color="#4169E1">REPEAT</font>
        ADV(Pr,Pf,Pr);
        AL:=DIDPLEXTAL(AL,Pf);
        t1:=DIPEVL(Pf);
        a1:=DIPLBC(Pf);
        Prp:=Pr;
            <font color="#4169E1">REPEAT</font>
                ADV(Prp,Pfp,Prp);
                t2:=DIPEVL(Pfp);
                a2:=DIPLBC(Pfp);
                lcmHT:=EVLCM(t1,t2);
                lcmHK:=ADLCM(a1,a2);
                CPLel:=LIST3(lcmHT,lcmHK,LIST2(Pf,Pfp));
                CPL:=COMP(CPLel,CPL);
            <font color="#4169E1">UNTIL</font> (Prp = SIL);
    <font color="#4169E1">UNTIL</font> (RED(Pr) = SIL);
<font color="#B22222">(*9*)</font> AL:=DIDPLEXTAL(AL,FIRST(Pr));
<strong><font color="#4169E1">END</font></strong> DIDPLCPL4;


<strong><font color="#4169E1">PROCEDURE DIDPALCMPC</font></strong>(AL, g1, g2, flag : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial array list check and mark polynomials.
AL is an array list. g1, g2 are polynomials in
distributive representation in r variables.
flag determines whether the pair will be
marked as computed or only checked. 1 means to
mark 0 only to check.
The value 1 is returned if the pair (g1,g2) is
already computed otherwise 0 is returned. *)</font>

<strong><font color="#228B22">VAR</font></strong> i, j , Ar, Af, Aff, Afr, nulll : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> AL = SIL <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> (g1 = 0) <font color="#4169E1">OR</font> (g2 = 0) <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> g1 = g2 <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> Ar:=AL;
    i:=0;
    j:=0;
    LOOP
        i:=i+1;
        ADV(Ar,Af,Ar);
        FIRST2(Af,Aff,Afr);
        <font color="#4169E1">IF</font> ((Aff = g1) <font color="#4169E1">OR</font> (Aff = g2)) <font color="#4169E1">AND</font> (j = 0)
        <font color="#4169E1">THEN</font>
            j:=i;
            <font color="#4169E1">IF</font> Ar = SIL
            <font color="#4169E1">THEN</font> EXIT;
            <strong><font color="#4169E1">END</font></strong>;
            ADV(Ar,Af,Ar);
            FIRST2(Af,Aff,Afr);
        <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> ((Aff = g1) <font color="#4169E1">OR</font> (Aff = g2)) <font color="#4169E1">AND</font> (j &lt;&gt; 0)
        <font color="#4169E1">THEN</font>
            nulll:=Afr;
            i:=1;
            <font color="#4169E1">WHILE</font> (i &lt; j) <font color="#4169E1">AND</font> (nulll &lt;&gt; SIL) <font color="#4169E1">DO</font>
                nulll:=RED(nulll);
                i:=i+1;
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> nulll = SIL
               <font color="#4169E1">THEN</font> RETURN(0);
            <font color="#4169E1">ELSE</font>
                <font color="#4169E1">IF</font> flag = 1
                <font color="#4169E1">THEN</font> SFIRST(nulll,1);
                <strong><font color="#4169E1">END</font></strong>;
                <font color="#4169E1">IF</font> FIRST(nulll) = 1
                <font color="#4169E1">THEN</font> RETURN(1);
                <font color="#4169E1">ELSE</font> RETURN(0);
                <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> Ar = SIL <font color="#4169E1">THEN</font> EXIT; <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*9*)</font> RETURN(0); <strong><font color="#4169E1">END</font></strong> DIDPALCMPC;



<strong><font color="#4169E1">PROCEDURE crit1</font></strong>(pair : LIST) : LIST;
<font color="#B22222">(*Distributive polymomial criterion1.
pair is a pair two integral polynomials in
distributive representation.
criterion1 returns 1 if the highest coeffizients of
the two polynomials are divisible otherwise it
returns 0. *)</font>

<strong><font color="#228B22">VAR</font></strong> HKQf, HKPf : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> pair = SIL <font color="#4169E1">THEN</font> RETURN 0; <strong><font color="#4169E1">END</font></strong>;
      HKQf:=DIPLBC(FIRST(pair)); HKPf:=DIPLBC(SECOND(pair));
      <font color="#4169E1">IF</font> ADSIGN(ADREM(HKPf,HKQf)) = 0  <font color="#B22222">(* HKQf divides HKPf! *)</font>
         <font color="#4169E1">THEN</font> RETURN(1); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> ADSIGN(ADREM(HKQf,HKPf)) = 0  <font color="#B22222">(* HKPf divides HKQf! *)</font>
         <font color="#4169E1">THEN</font> RETURN(1); <strong><font color="#4169E1">END</font></strong>; 
<font color="#B22222">(*9*)</font> RETURN(0); <strong><font color="#4169E1">END</font></strong> crit1;



<strong><font color="#4169E1">PROCEDURE crit2</font></strong>(pair, lcmHT, lcmHK : LIST) : LIST;
<font color="#B22222">(*Distributive polymomial criterion2.
pair is a pair two integral polynomials in
distributive representation.
lcmHT is the lcm of the highest terms of the two
polynomials in pair.
lcmHK is the lcm of the highest coefficients of the two
polynomials in pair.
criterion2 returns 1 if the highest monomials of
the two polynomials are disjoint otherwise it
returns 0. *)</font>

<strong><font color="#228B22">VAR</font></strong> prodHT, prodHK : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> pair = SIL <font color="#4169E1">THEN</font> RETURN 0 <strong><font color="#4169E1">END</font></strong>;
      prodHT:=EVSUM(DIPEVL(FIRST(pair)),DIPEVL(SECOND(pair)));
      <font color="#4169E1">IF</font> EVCOMP(lcmHT,prodHT) = 0 <font color="#4169E1">THEN</font>
         prodHK:=ADABSF(ADPROD(DIPLBC(FIRST(pair)),DIPLBC(SECOND(pair))));
         <font color="#4169E1">IF</font> ADCOMP(lcmHK,prodHK) = 0 <font color="#4169E1">THEN</font> RETURN(1); <strong><font color="#4169E1">END</font></strong>;
         <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*9*)</font> RETURN(0); <strong><font color="#4169E1">END</font></strong> crit2;



<strong><font color="#4169E1">PROCEDURE crit3</font></strong>(AL, pair, lcmHT, lcmHK : LIST) : LIST;
<font color="#B22222">(*Distributive polymomial criterion3.
pair is a pair two integral polynomials in
distributive representation.
AL is the constructed pairs list.
lcmHT is the lcm of the highest terms of the two
polynomials in pair.
lcmHK is the lcm of the highest coefficients of the two
polynomials in pair.
criterion3 returns 1 if (4) of the D-greobner base
algorithm is true otherwise it returns 0. *)</font>

<strong><font color="#228B22">VAR</font></strong> p, Af, Ar, Aff, Afr, HTAf, HKAf : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#4169E1">IF</font> pair = SIL <font color="#4169E1">THEN</font> RETURN 0 <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> AL = SIL <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> p:=0;
        Ar:=AL;
    LOOP
        ADV(Ar,Af,Ar);
        ADV(Af,Aff,Afr);
        HTAf:=DIPEVL(Aff);
        HKAf:=DIPLBC(Aff);
        <font color="#4169E1">IF</font> EVMT(lcmHT,HTAf) = 1
           <font color="#4169E1">THEN</font>
           <font color="#4169E1">IF</font> ADSIGN(ADREM(lcmHK,HKAf)) = 0
            <font color="#4169E1">THEN</font>
                p:=Aff;
                EXIT;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> Ar = SIL
        <font color="#4169E1">THEN</font> EXIT;
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> p = 0 <font color="#4169E1">THEN</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> (DIDPALCMPC(AL,p,FIRST(pair),0) = 1) 
       <font color="#4169E1">AND</font> (DIDPALCMPC(AL,p,SECOND(pair),0) = 1)
       <font color="#4169E1">THEN</font> RETURN(1);
       <font color="#4169E1">ELSE</font> RETURN(0); <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*9*)</font> <strong><font color="#4169E1">END</font></strong> crit3;


<strong><font color="#4169E1">PROCEDURE DIDPENF</font></strong>(P,varl,g: LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial E-normal form. P is a list
of non zero polynomials in distributive integral
representation in r variables. g is a distributive
integral polynomial. ENF is a polynomial such that
g is e-reducible to ENF modulo P and ENF is in
E-normalform modulo P. *)</font>

<strong><font color="#228B22">VAR</font></strong> a, ap, app, b, c, f, PP, q, qa, qt, qr, ENF, rp, rs, teilt, gr, ga,
      gt, gf, rest: LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*s=0. *)</font>
      <font color="#4169E1">IF</font> g = 0 <font color="#4169E1">THEN</font> ENF:=varl; RETURN(ENF); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> P = SIL
         <font color="#4169E1">THEN</font>
            <font color="#4169E1">IF</font> varl = 0
            <font color="#4169E1">THEN</font> ENF:=g;
            <font color="#4169E1">ELSE</font> ENF:=CCONC(varl,g);
            <strong><font color="#4169E1">END</font></strong>;
            RETURN(ENF);
      <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(*reduction step.*)</font> gf:=g; ENF:=varl;
    <font color="#4169E1">REPEAT</font>
          DIPMAD(gf, ga,gt,gr); <font color="#B22222">(* ga = HK(g), gt = HT(g), *)</font>
                                <font color="#B22222">(* gr = g - HM(g) *)</font>
          <font color="#4169E1">IF</font> gr = SIL <font color="#4169E1">THEN</font> gr:=0; <strong><font color="#4169E1">END</font></strong>;
        PP:=P;
        LOOP
            ADV(PP, q,PP);
            DIPMAD(q, qa,qt,qr);  <font color="#B22222">(* qa = HK(q), qt = HT(q), *)</font>
                                  <font color="#B22222">(* qr = q - HM(q) *)</font>
            teilt:=EVMT(gt,qt);
            <font color="#4169E1">IF</font> (teilt = 1)
            <font color="#4169E1">THEN</font>
                ADQR(ga,qa,a,rest); <font color="#B22222">(* a = ga div qa, rest = ga-a*qa *)</font>
                <font color="#4169E1">IF</font> ADSIGN(rest) = 0
                <font color="#4169E1">THEN</font>
                    <font color="#4169E1">IF</font> qr &lt;&gt; SIL
                        <font color="#4169E1">THEN</font>
                        f:=EVDIF(gt,qt);  <font color="#B22222">(* f = gt div qt *)</font>
                        ap:=DIPFMO(a,f);  <font color="#B22222">(* ap = a*f *)</font>
                        app:=DIPROD(qr,ap); <font color="#B22222">(* app = qr*ap *)</font>
                        gr:=DIPDIF(gr,app); <font color="#B22222">(* gr = gr-app *)</font>
                        <strong><font color="#4169E1">END</font></strong>;
                    gf:=gr;
                    EXIT;
                <font color="#4169E1">ELSE</font>
                    <font color="#4169E1">IF</font> ADSIGN(a) &lt;&gt; 0
                    <font color="#4169E1">THEN</font>
                        f:=EVDIF(gt,qt);    <font color="#B22222">(* f = gt div qt *)</font>
                        ap:=DIPFMO(a,f);    <font color="#B22222">(* ap = a*f *)</font>
                        app:=DIPROD(q,ap);  <font color="#B22222">(* app = ap*qr *)</font>
                        gf:=DIPDIF(gf,app);
                        DIPMAD(gf, ga,gt,gr);
                        <font color="#4169E1">IF</font> gr = SIL
                           <font color="#4169E1">THEN</font> gr:=0;
                        <strong><font color="#4169E1">END</font></strong>;
                    <strong><font color="#4169E1">END</font></strong>;
                <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> (PP = SIL)
            <font color="#4169E1">THEN</font>
                rp:=DIPFMO(ga,gt);
                <font color="#4169E1">IF</font> ENF = 0
                <font color="#4169E1">THEN</font> ENF:=rp;
                <font color="#4169E1">ELSE</font> ENF:=CONC(ENF,rp);
                <strong><font color="#4169E1">END</font></strong>;
                gf:=gr;
                EXIT;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">UNTIL</font> gr = 0;
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> RETURN(ENF);
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIDPENF;



<strong><font color="#4169E1">PROCEDURE DIDPREDDGB</font></strong>(P : LIST) : LIST;
<font color="#B22222">(*Distributive domain polynomial reduce D-groebner base.
P is a list of non zero polynomials in distributive
integral representation in r variables.
REDDGB reduces the polynominials.
It is nescessary that the highest monomials are
pairwise disjoint. *)</font>

<strong><font color="#228B22">VAR</font></strong> Q, Qf, Qr, Qred, len, i : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> Q:=SIL;
      len:=LENGTH(P);
      <font color="#4169E1">IF</font> len &lt; 2 <font color="#4169E1">THEN</font> RETURN(P); <strong><font color="#4169E1">END</font></strong>;
      Q:=CINV(P);
      Qr:=Q;
      i:=0;
      <font color="#4169E1">WHILE</font> i &lt; len <font color="#4169E1">DO</font> ADV(Qr,Qf,Qr);
            Qred:=DIDPENF(Qr,0,Qf);
            <font color="#4169E1">IF</font> Qred &lt;&gt; 0
               <font color="#4169E1">THEN</font> Qr:=CONC(Qr,LIST1(Qred));
               <font color="#4169E1">ELSE</font> len:=len-1; <strong><font color="#4169E1">END</font></strong>;
            i:=i+1;
            <strong><font color="#4169E1">END</font></strong>;
      Q:=INV(Qr);
<font color="#B22222">(*9*)</font> RETURN(Q); <strong><font color="#4169E1">END</font></strong> DIDPREDDGB;



<strong><font color="#4169E1">PROCEDURE DIDPSPOL</font></strong>(g1,g2: LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial s polynomial. g1 and g2 are
integral polynomials in distributive representation.
SPol is the S-polynomial of g1 and g2. *)</font>

<strong><font color="#228B22">VAR</font></strong>   a1, b1, g1r, g1rp, a2, b2, g2r, g2rp, SPol,
          lcmHK, t1, s1, t2, s2, lcmHT: LIST;
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*a=0 or b=0. *)</font> SPol:=0;
    <font color="#4169E1">IF</font> (g1 = 0) <font color="#4169E1">OR</font> (g2 = 0)
    <font color="#4169E1">THEN</font> RETURN(SPol); <font color="#B22222">(* SPol = 0 *)</font>
    <strong><font color="#4169E1">END</font></strong>;
    DIPMAD(g1, a1,t1,g1r); <font color="#B22222">(* a1 = HK(g1), t1 = HT(g2), a2 = HK(g2) *)</font>
    DIPMAD(g2, a2,t2,g2r); <font color="#B22222">(* t2 = HT(g2) g1r = g1 - HM(g1) *)</font>
                           <font color="#B22222">(* g2r = g2 - HM(g2) *)</font>
    <font color="#4169E1">IF</font> (g1r = SIL) <font color="#4169E1">AND</font> (g2r = SIL)
    <font color="#4169E1">THEN</font> RETURN(SPol);     <font color="#B22222">(* SPol = 0 *)</font>
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(* reduction. *)</font>
      lcmHT:=EVLCM(t1,t2); <font color="#B22222">(* lcmHT = lcm of the highest terms *)</font>
      lcmHK:=ADLCM(a1,a2); <font color="#B22222">(* lcmHK = lcm of the highest coeffic. *)</font>
        <font color="#4169E1">IF</font> g1r = SIL
    <font color="#4169E1">THEN</font>
        s2:=EVDIF(lcmHT,t2);    <font color="#B22222">(* s2 = lcmHT/t2 *)</font>
        b2:=ADQUOT(lcmHK,a2);   <font color="#B22222">(* b2 = lcmHK/a2 *)</font>
        b2:=ADNEG(b2);          <font color="#B22222">(* b2 = -b2 *)</font>
        g2rp:=DIPFMO(b2,s2);    <font color="#B22222">(* g2rp = -b2*s2 *)</font>
        SPol:=DIPROD(g2r,g2rp); <font color="#B22222">(* SPol = -b2*s2*g2 *)</font>
        RETURN(SPol);
    <strong><font color="#4169E1">END</font></strong>;
        <font color="#4169E1">IF</font> g2r = SIL
    <font color="#4169E1">THEN</font>
        s1:=EVDIF(lcmHT,t1);
        b1:=ADQUOT(lcmHK,a1);
        g1rp:=DIPFMO(b1,s1);
        SPol:=DIPROD(g1r,g1rp);
        RETURN(SPol);
    <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*3*)</font> <font color="#B22222">(* general case. *)</font>
      s1:=EVDIF(lcmHT,t1);
      b1:=ADQUOT(lcmHK,a1);
      s2:=EVDIF(lcmHT,t2);
      b2:=ADQUOT(lcmHK,a2);
      g1rp:=DIPFMO(b1,s1);
      g2rp:=DIPFMO(b2,s2);
      g1rp:=DIPROD(g1r,g1rp);
      g2rp:=DIPROD(g2r,g2rp);
      SPol:=DIPDIF(g1rp,g2rp);  <font color="#B22222">(* SPol = b1*s1*g1 - b2*s2*g2 *)</font>
<font color="#B22222">(*6*)</font> RETURN(SPol);
<strong><font color="#4169E1">END</font></strong> DIDPSPOL;


<strong><font color="#4169E1">PROCEDURE DIDPDNF</font></strong>(P,varl,g: LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial D-normal form. P is a list
of non zero polynomials in distributive integral
representation in r variables. g is a distributive
integral polynomial. NF is a polynomial such that
g is reducible to NF modulo P and NF is in
D-normalform modulo P. *)</font>

<strong><font color="#228B22">VAR</font></strong> a, ap, app, b, c, f, PP, q, qa, qt, qr, NF, rp, rs, teilt, gr, ga,
      gt, rest: LIST;
<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> <font color="#B22222">(*s=0. *)</font>
      <font color="#4169E1">IF</font> g = 0 <font color="#4169E1">THEN</font> NF:=varl; RETURN(NF); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> P = SIL
         <font color="#4169E1">THEN</font>
             <font color="#4169E1">IF</font> varl = 0
             <font color="#4169E1">THEN</font> NF:=g;
             <font color="#4169E1">ELSE</font> NF:=CCONC(varl,g);
             <strong><font color="#4169E1">END</font></strong>;
             RETURN(NF);
         <strong><font color="#4169E1">END</font></strong>;
<font color="#B22222">(*2*)</font> <font color="#B22222">(*reduction step.*)</font> gr:=g; NF:=varl;
    <font color="#4169E1">REPEAT</font>
        DIPMAD(gr, ga,gt,gr); <font color="#B22222">(* ga = HK(g), gt = HT(g), *)</font>
                              <font color="#B22222">(* gr = g - HM(g) *)</font>
                              <font color="#B22222">(* Das Nullpolynom ist nicht die *)</font>
        <font color="#4169E1">IF</font> gr = SIL <font color="#4169E1">THEN</font> gr:=0; <strong><font color="#4169E1">END</font></strong>;
        PP:=P;
        <font color="#4169E1">REPEAT</font>
                ADV(PP, q,PP);
                DIPMAD(q, qa,qt,qr); <font color="#B22222">(* qa = HK(q), qt = HT(q), *)</font>
                                     <font color="#B22222">(* qr = q - HM(q) *)</font>
                teilt:=EVMT(gt,qt);
                ADQR(ga,qa,a,rest);
                <font color="#4169E1">UNTIL</font> (PP = SIL) <font color="#4169E1">OR</font> ((teilt = 1) <font color="#4169E1">AND</font> (ADSIGN(rest) = 0));
                <font color="#4169E1">IF</font> (teilt = 1) <font color="#4169E1">AND</font> (ADSIGN(rest) = 0)
        <font color="#4169E1">THEN</font>
                        <font color="#4169E1">IF</font> qr &lt;&gt; SIL
                        <font color="#4169E1">THEN</font>
                            f:=EVDIF(gt,qt);
                            ap:=DIPFMO(a,f);
                            app:=DIPROD(qr,ap);
                            gr:=DIPDIF(gr,app);
                        <strong><font color="#4169E1">END</font></strong>;
                <font color="#4169E1">ELSE</font>
                        rp:=DIPFMO(ga,gt);
                        <font color="#4169E1">IF</font> NF = 0
                        <font color="#4169E1">THEN</font> NF:=rp;
                        <font color="#4169E1">ELSE</font> NF:= CONC(NF,rp);
                        <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
                <font color="#4169E1">UNTIL</font> gr = 0;
<font color="#B22222">(*3*)</font> <font color="#B22222">(*finish.*)</font> RETURN(NF);
<font color="#B22222">(*6*)</font> <strong><font color="#4169E1">END</font></strong> DIDPDNF;



<strong><font color="#4169E1">PROCEDURE DIDPDGB</font></strong>(F, TF : LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial D-groebner basis. F is a
list of integral polynomials in distributive representation
in r variables. G is the groebner basis of F. TF the trace flag. *)</font>

<strong><font color="#228B22">VAR</font></strong> G, B, B1, Bf, D, D1, C, Cf, lcmHT, lcmHK, egcdHK, infoSPol, infoGPol,
    pair, h, hp, AL, dummy, AGPol, ASPol, GPol, SPol, NGPolkr1, NSPolkr2,
    NSPolkr3, NGPoltr : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> G:=F;
      <font color="#4169E1">IF</font> (G = SIL) <font color="#4169E1">THEN</font> RETURN(G); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> (RED(G) = SIL) <font color="#4169E1">THEN</font> RETURN(G); <strong><font color="#4169E1">END</font></strong>;
    B:=SIL;
    AL:=SIL;
    DIDPLCPL4(G,B,AL);      <font color="#B22222">(* list construction *)</font>
    B:=DIDPCPLMS1(B);       <font color="#B22222">(* list sort *)</font>
    D:=SIL;
    B1:=CINV(B);
    C:=INV(B1);
    infoSPol:=1;            <font color="#B22222">(* info in G-loop *)</font>
    infoGPol:=1;            <font color="#B22222">(* info in S-loop *)</font>
    AGPol:=0;
    NGPolkr1:=0;
    NGPoltr:=0;
    ASPol:=0;
    NSPolkr2:=0;
    NSPolkr3:=0;
    SPol:=0;
    GPol:=0;
    <font color="#4169E1">WHILE</font> B &lt;&gt; SIL <font color="#4169E1">DO</font>
        <font color="#4169E1">WHILE</font> C &lt;&gt; SIL <font color="#4169E1">DO</font>
            ADV(C,Cf,C);
            AGPol:=AGPol+1;
            FIRST3(Cf,lcmHT,lcmHK,pair);
            <font color="#4169E1">IF</font> crit1(pair) = 1
            <font color="#4169E1">THEN</font>
                hp:=0;
                NGPolkr1:=NGPolkr1+1;
                ELSIF DIDPTDR(G, lcmHT, pair) = 1
            <font color="#4169E1">THEN</font>
                hp:=0;
                NGPoltr:=NGPoltr+1;
            <font color="#4169E1">ELSE</font>
                h:=DIDPGPOL(FIRST(pair),SECOND(pair));
                hp:=DIDPDNF(G,0,h);
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> hp &lt;&gt; 0
            <font color="#4169E1">THEN</font>
                AL:=DIDPLEXTAL(AL,hp);
                D:=DIDPUCPL1(G,hp,D);
                G:=COMP(hp,G);
                GPol:=GPol+1;
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> TF &lt;&gt; 0
            <font color="#4169E1">THEN</font>
                <font color="#4169E1">IF</font> infoGPol = TF
                <font color="#4169E1">THEN</font>
                    SWRITE("Number <font color="#4169E1">of</font> computed G-polynomials: ");
                    IWRITE(AGPol);BLINES(0);
                    SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 1: ");
                    IWRITE(NGPolkr1);BLINES(0);
                    SWRITE("Cancelled due <font color="#4169E1">to</font> top-D-reducibility: ");
                    IWRITE(NGPoltr);BLINES(0);
                    SWRITE("New polynomials added <font color="#4169E1">to</font> G: ");
                    IWRITE(GPol);BLINES(0);
                    SWRITE("Number <font color="#4169E1">of</font> critical pairs in D: ");
                    IWRITE(LENGTH(D));BLINES(0);
                    SWRITE("Number <font color="#4169E1">of</font> critical pairs in C: ");
                    IWRITE(LENGTH(C));BLINES(1);
                    infoGPol:=1;
                <font color="#4169E1">ELSE</font> infoGPol:=infoGPol+1;
                <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        ADV(B,Bf,B);
        ASPol:=ASPol+1;
        FIRST3(Bf,lcmHT,lcmHK,pair);
        <font color="#4169E1">IF</font> crit2(pair, lcmHT, lcmHK) = 1
        <font color="#4169E1">THEN</font>
            hp:=0;
            NSPolkr2:=NSPolkr2+1;
            ELSIF crit3(AL, pair, lcmHT, lcmHK) = 1
        <font color="#4169E1">THEN</font>
            hp:=0;
            NSPolkr3:=NSPolkr3+1;
        <font color="#4169E1">ELSE</font>
                h:=DIDPSPOL2(FIRST(pair),SECOND(pair),lcmHT,lcmHK);
                hp:=DIDPDNF(G,0,h);
                <strong><font color="#4169E1">END</font></strong>;
                dummy:=DIDPALCMPC(AL,FIRST(pair),SECOND(pair),1);
        <font color="#4169E1">IF</font> hp &lt;&gt; 0
        <font color="#4169E1">THEN</font>
            AL:=DIDPLEXTAL(AL,hp);
            D:=DIDPUCPL1(G,hp,D);
            G:=COMP(hp,G);
            SPol:=SPol+1;
        <strong><font color="#4169E1">END</font></strong>;
        D1:=CINV(D);
        C:=INV(D1);
        B:=DIDPLM1(B,D);
        D:=SIL;
        <font color="#4169E1">IF</font> TF &lt;&gt; 0
        <font color="#4169E1">THEN</font>
            <font color="#4169E1">IF</font> infoSPol = TF
            <font color="#4169E1">THEN</font>
                SWRITE("Number <font color="#4169E1">of</font> computed S-polynomials: ");
                IWRITE(ASPol);BLINES(0);
                SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 2: ");
                IWRITE(NSPolkr2);BLINES(0);
                SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 3: ");
                IWRITE(NSPolkr3);BLINES(0);
                SWRITE("New polynomials added <font color="#4169E1">to</font> G: ");
                IWRITE(SPol);BLINES(0);
                SWRITE("Number <font color="#4169E1">of</font> critical pairs in B: ");
                IWRITE(LENGTH(B));BLINES(0);
                SWRITE("Number <font color="#4169E1">of</font> critical pairs in C: ");
                IWRITE(LENGTH(C));BLINES(1);
                infoSPol:=1;
            <font color="#4169E1">ELSE</font> infoSPol:=infoSPol+1;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> TF &lt;&gt; 0
    <font color="#4169E1">THEN</font>
        SWRITE("Number <font color="#4169E1">of</font> computed G-polynomials: ");
        IWRITE(AGPol);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 1: ");
        IWRITE(NGPolkr1);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> top-D-reducibility: ");
        IWRITE(NGPoltr);BLINES(0);
        SWRITE("Number <font color="#4169E1">of</font> computed S-polynomials: ");
        IWRITE(ASPol);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 2: ");
        IWRITE(NSPolkr2);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 3: ");
        IWRITE(NSPolkr3);BLINES(1);
        SWRITE("Number <font color="#4169E1">of</font> polynomials in G before reduction: ");
        IWRITE(LENGTH(G));
        BLINES(0);
    <strong><font color="#4169E1">END</font></strong>;
        G:=DIDPELIMDGB(G);
    <font color="#4169E1">IF</font> TF &lt;&gt; 0
    <font color="#4169E1">THEN</font>
        SWRITE("Number <font color="#4169E1">of</font> polynomials in G after reduction: ");
        IWRITE(LENGTH(G));
        BLINES(1);
    <strong><font color="#4169E1">END</font></strong>;
    G:=DIDPREDDGB(G);
<font color="#B22222">(*9*)</font> RETURN(G); <strong><font color="#4169E1">END</font></strong> DIDPDGB;



<strong><font color="#4169E1">PROCEDURE DIDPEGB</font></strong>(F, DP, TF : LIST): LIST;
<font color="#B22222">(*Distributive domain polynomial E-groebner basis. F is a
list of integral polynomials in distributive representation
in r variables.
DP is a domain element with descriptor.
G is the groebner basis of F. TF the trace flag. *)</font>

<strong><font color="#228B22">VAR</font></strong>   G, B, B1, Bf, D, D1, C, Cf, lcmHT, lcmHK, egcdHK, infoSPol, infoGPol,
      pair, h, hp, AL, dummy, AGPol, ASPol, GPol, SPol, NGPolkr1, NSPolkr2,
      NSPolkr3, NGPoltr, DL : LIST;

<strong><font color="#4169E1">BEGIN</font></strong>
<font color="#B22222">(*1*)</font> G:=F;
      <font color="#4169E1">IF</font> G = SIL <font color="#4169E1">THEN</font> RETURN(G); <strong><font color="#4169E1">END</font></strong>;
      <font color="#4169E1">IF</font> RED(G) = SIL <font color="#4169E1">THEN</font> RETURN(G); <strong><font color="#4169E1">END</font></strong>;
    B:=SIL;
    AL:=SIL;
    DIDPLCPL4(G,B,AL);
    B:=DIDPCPLMS1(B);
    D:=SIL;
    B1:=CINV(B);
    C:=INV(B1);
    infoSPol:=1;
    infoGPol:=1;
    AGPol:=0;
    NGPolkr1:=0;
    NGPoltr:=0;
    ASPol:=0;
    NSPolkr2:=0;
    NSPolkr3:=0;
    SPol:=0;
    GPol:=0;
    <font color="#4169E1">WHILE</font> B &lt;&gt; SIL <font color="#4169E1">DO</font>
        <font color="#4169E1">WHILE</font> C &lt;&gt; SIL <font color="#4169E1">DO</font>
            ADV(C,Cf,C);
            AGPol:=AGPol+1;
            FIRST3(Cf,lcmHT,lcmHK,pair);
            <font color="#4169E1">IF</font> crit1(pair) = 1
            <font color="#4169E1">THEN</font>
                hp:=0;
                NGPolkr1:=NGPolkr1+1;
                ELSIF DIDPTDR(G, lcmHT, pair) = 1
            <font color="#4169E1">THEN</font>
                hp:=0;
                NGPoltr:=NGPoltr+1;
            <font color="#4169E1">ELSE</font>
                h:=DIDPGPOL(FIRST(pair),SECOND(pair));
                hp:=DIDPENF(G,0,h);
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> hp &lt;&gt; 0
            <font color="#4169E1">THEN</font>
                AL:=DIDPLEXTAL(AL,hp);
                D:=DIDPUCPL1(G,hp,D);
                G:=COMP(hp,G);
                GPol:=GPol+1;
                <font color="#B22222">(*SRED(LAST(G),LIST1(hp));*)</font>
            <strong><font color="#4169E1">END</font></strong>;
            <font color="#4169E1">IF</font> TF &lt;&gt; 0
            <font color="#4169E1">THEN</font>
                <font color="#4169E1">IF</font> infoGPol = TF
                <font color="#4169E1">THEN</font>
                    SWRITE("Number <font color="#4169E1">of</font> computed G-polynomials: ");
                    IWRITE(AGPol);BLINES(0);
                    SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 1: ");
                    IWRITE(NGPolkr1);BLINES(0);
                    SWRITE("Cancelled due <font color="#4169E1">to</font> top-D-reducibility: ");
                    IWRITE(NGPoltr);BLINES(0);
                    SWRITE("New polynomials added <font color="#4169E1">to</font> G: ");
                    IWRITE(GPol);BLINES(0);
                    SWRITE("Number <font color="#4169E1">of</font> critical pairs in D: ");
                    IWRITE(LENGTH(D));BLINES(0);
                    SWRITE("Number <font color="#4169E1">of</font> critical pairs in C: ");
                    IWRITE(LENGTH(C));BLINES(1);
                    infoGPol:=1;
                <font color="#4169E1">ELSE</font> infoGPol:=infoGPol+1;
                <strong><font color="#4169E1">END</font></strong>;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
        ADV(B,Bf,B);
        ASPol:=ASPol+1;
        FIRST3(Bf,lcmHT,lcmHK,pair);
        <font color="#4169E1">IF</font> crit2(pair, lcmHT, lcmHK) = 1
        <font color="#4169E1">THEN</font>
            hp:=0;
            NSPolkr2:=NSPolkr2+1;
        ELSIF crit3(AL, pair, lcmHT, lcmHK) = 1
        <font color="#4169E1">THEN</font>
            hp:=0;
            NSPolkr3:=NSPolkr3+1;
        <font color="#4169E1">ELSE</font>
            h:=DIDPSPOL2(FIRST(pair),SECOND(pair),lcmHT,lcmHK);
            hp:=DIDPENF(G,0,h);
            <strong><font color="#4169E1">END</font></strong>;
            dummy:=DIDPALCMPC(AL,FIRST(pair),SECOND(pair),1);
        <font color="#4169E1">IF</font> hp &lt;&gt; 0
        <font color="#4169E1">THEN</font>
            AL:=DIDPLEXTAL(AL,hp);
            D:=DIDPUCPL1(G,hp,D);
            G:=COMP(hp,G);
            SPol:=SPol+1;
        <strong><font color="#4169E1">END</font></strong>;
        D1:=CINV(D);
        C:=INV(D1);
        B:=DIDPLM1(B,D);
        D:=SIL;
        <font color="#4169E1">IF</font> TF &lt;&gt; 0
        <font color="#4169E1">THEN</font>
            <font color="#4169E1">IF</font> infoSPol = TF
            <font color="#4169E1">THEN</font>
                SWRITE("Number <font color="#4169E1">of</font> computed S-polynomials: ");
                IWRITE(ASPol);BLINES(0);
                SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 2: ");
                IWRITE(NSPolkr2);BLINES(0);
                SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 3: ");
                IWRITE(NSPolkr3);BLINES(0);
                SWRITE("New polynomials added <font color="#4169E1">to</font> G: ");
                IWRITE(SPol);BLINES(0);
                SWRITE("Number <font color="#4169E1">of</font> critical pairs in B: ");
                IWRITE(LENGTH(B));BLINES(0);
                SWRITE("Number <font color="#4169E1">of</font> critical pairs in C: ");
                IWRITE(LENGTH(C));BLINES(1);
                infoSPol:=1;
            <font color="#4169E1">ELSE</font> infoSPol:=infoSPol+1;
            <strong><font color="#4169E1">END</font></strong>;
        <strong><font color="#4169E1">END</font></strong>;
    <strong><font color="#4169E1">END</font></strong>;
    <font color="#4169E1">IF</font> TF &lt;&gt; 0
    <font color="#4169E1">THEN</font>
        SWRITE("Number <font color="#4169E1">of</font> computed G-polynomials: ");
        IWRITE(AGPol);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 1: ");
        IWRITE(NGPolkr1);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> top-D-reducibility: ");
        IWRITE(NGPoltr);BLINES(0);
        SWRITE("Number <font color="#4169E1">of</font> computed S-polynomials: ");
        IWRITE(ASPol);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 2: ");
        IWRITE(NSPolkr2);BLINES(0);
        SWRITE("Cancelled due <font color="#4169E1">to</font> criterion 3: ");
        IWRITE(NSPolkr3);BLINES(1);
        SWRITE("Number <font color="#4169E1">of</font> polynomials in G before reduction: ");
        IWRITE(LENGTH(G));
        BLINES(0);
    <strong><font color="#4169E1">END</font></strong>;
        G:=DIDPELIMDGB(G);
    <font color="#4169E1">IF</font> TF &lt;&gt; 0
    <font color="#4169E1">THEN</font>
        SWRITE("Number <font color="#4169E1">of</font> polynomials in G after reduction: ");
        IWRITE(LENGTH(G));
        BLINES(1);
    <strong><font color="#4169E1">END</font></strong>;
      G:=DIDPREDDGB(G);
<font color="#B22222">(*9*)</font> RETURN(G); <strong><font color="#4169E1">END</font></strong> DIDPEGB;



<strong><font color="#4169E1">END</font></strong> DIPDDGB.



</pre>
</body>

</html>
